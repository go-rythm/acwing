## [1325. 麻将猜猜猜](https://www.acwing.com/problem/content/1327/)

### 题目

晨晨和小璐最近在一副麻将牌的基础上，设计出了一款不知怎么取名字的游戏，游戏具体规则如下：

游戏使用以下 *27* 张麻将牌或其中一部分牌进行，这 *27* 张牌分为万牌、条牌、饼牌三种牌型，每种牌型 *9* 张，分别为一万 (*1W*)、二万 (*2W*)......九万 (*9W*)，一条 (*1T*)、 二条 (*2T*)......九条 (*9T*)，一饼 (*1B*)、二饼 (*2B*)......九饼 (*9B*)，每张牌有且仅有一张。

这副麻将牌比较特殊，每张牌背面都标有这张牌的牌型。

两名游戏玩家，相对而坐，游戏开始时，每个人分配等量的若干张牌，剩余的牌叠好，构成一个牌库。

玩家将牌自左向右排成一排。

任何时刻都保证：玩家面前任意两张相邻的牌，较小的那张牌在左侧。

任意两张牌的大小定义为：若数字不相同，则数字较小的牌较小；若数字相同，万牌 (*W*) 比条牌 (*T*) 小，万牌 (*W*)、条牌 (*T*) 都比饼牌 (*B*) 小。

任何时刻，每个人知道自己所有牌的信息，还知道对方每一张牌的牌型，即知道对方的每一张牌是万牌/条牌/饼牌。

游戏开始之后，双方轮流进行自己的回合。

每回合中，当前进行回合的玩家先从牌库最上面摸一张牌并观看，之后按照自己的猜牌策略（详见后述），指定对方的一张牌，并猜其数字是多少。

如果猜对了，对方那张被猜中的牌就会被亮出，之后当前进行回合的玩家将自己摸进的这张牌按照大小插入自己的牌序列中适当的位置；猜错了，作为惩罚，需将自己刚摸进的这张牌亮出，之后将自己摸进的这张牌按照大小插入自己的牌序列中适当的位置。

特殊地，如果牌堆里的牌已经摸完，而游戏尚未结束，则回合中不再进行摸牌，只进行猜牌，若猜对，对方被猜中的牌就会被亮出，若猜错则什么也不会发生。

另外，游戏中玩家不能猜对方的某张牌是目前已经被自己摸到的某张牌。

对于一方被亮出的牌，另一方能知道这张牌是什么数字（这张牌的牌型在亮出前另一方已经知道）。

同时，玩家能够看到对方的牌序列发生的变化，即知道新摸进的牌插入的位置。

双方玩家各自知道的信息有：自己的牌、自己对对方的哪张牌猜过哪些数字、对方每张牌的牌型、对方已经亮出的牌的数字， **对方不会猜已经摸到的牌**，但不知道对方的猜牌策略。

某一时刻，如果某玩家所有牌已经全数亮出，则该玩家输，游戏结束。

晨晨的猜牌策略是：每次都猜小璐的牌序列中最小的未亮出的牌，猜的数字是根据自己掌握的信息，计算出的可能的最大数；小璐的猜牌策略是：每次都猜晨晨的牌序列中最大的未亮出的牌，猜的数字是根据自己掌握的信息，计算出的可能的最小数。

现在给出游戏开始时双方分配到的牌，牌库从顶至底的牌的顺序，请回答： **若晨晨先进行回合**，谁是胜利者，游戏结束时，获胜者还有多少张牌没有亮出来。

### 输入格式

共三行字符串。

第一行用一个字符串描述游戏开始时，晨晨手里的若干张牌；

第二行用一个字符串描述游戏开始时，小璐手里的若干张牌；

第三行依次描述的是牌堆自顶而下每张牌，保证无多余空格与回车。

描述格式如下：每个字符串都由 *2n* 个字符组成，每两个字符表示一张牌，第一个字符为牌的数字，第二个字符为牌的牌型，例如 *1W、6T、9B*，分别表示一万、六条、 九饼。

### 输出格式

第一行一个字符，表示获胜者，*C* 表示晨晨，*L* 表示小璐；

第二行一个数字，表示游戏结束时，获胜者还有多少张牌没有亮出来（如果这个回合获胜者有进行摸牌，则包括刚摸进的那张牌）。

### 数据范围

 ![QQ截图20200211164642.png](https://cdn.acwing.com/media/article/image/2020/02/11/19_12ca17a04c-QQ截图20200211164642.png)

牌型数指本局游戏使用的牌中，有多少种不同的牌型（万牌、饼牌、条牌）。

起始牌数指游戏开始时，每名玩家分配到的牌的数量。

### 输入样例1：

```
1W
9W
2W3W4W5W6W7W8W
```

### 输出样例1：

```
C
2
```

### 输入样例2：

```
1W1T1B
3W4W5W
2W2T3T4T5T6T7T8T2B3B4B5B6B7B8B6W7W8W9W9T9B
```

### 输出样例2：

```
L
6
```

### 提示

1、游戏开始时双方的若干张牌可能尚未排序。

2、双方游戏开始时分配到的牌 + 牌堆里的牌可能仅包含部分牌型，但一定包含该牌型的所有牌，例如，此局游戏只含有万牌，则牌堆为一万到九万，共 9 张牌。

3、根据两人的策略和知道的信息，我们可以推出晨晨的具体计算方法为：先考虑对方序列中没有亮出的最大的牌，推测它最大可能是哪一张牌，接着基于之前的推测继 续考虑次大的未亮出的牌，直到序列最小的那张未亮出的牌；小璐的具体计算方法为：先考虑对方序列中没有亮出的最小的牌，推测它最小可能是哪一张牌，接着基于之前的推测继续考虑次小的未亮出的牌，直到序列最大的那张未亮出的牌。

### 样例解释

对于样例一，晨晨的第一个回合摸进一张牌二万 (2W)，她知道对方只有一张万牌，对方最小的为亮出的牌是九万 (9W)，晨晨会猜可能的最大数九万 (9W)，猜测正确，小璐所有的牌都已经亮出，所以晨晨获胜，算上刚摸进的二万 (2W)，晨晨胜利时还有一万 (1W)、二万 (2W) 共两张牌未亮出。
