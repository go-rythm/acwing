## [578. 去观光](https://www.acwing.com/problem/content/580/)

### 题目

当你旅行时，你希望可以游览尽可能多的城市，但是你需要搭乘巴士从一个城市前往下一个城市。

为了让旅行变得更有趣，你决定编写一个程序来优化你的日程安排。

在 *0* 时刻，你处于城市 *1*，并计划按升序的顺序前往城市 *2* 到 *N*，访问每个城市。

从每个城市 *i* 到下一个城市 *i + 1* 之间都有巴士服务。

第 *i* 个巴士的始发时间为 *S_i*，发车间隔为 *F_i*，乘车持续时间为 *D_i*。

这意味着所有 *S_i + xF_i* 时刻都会有一辆巴士从城市 *i* 发车，其中 *x* 为非负整数，巴士需要 *D_i* 时间才能到达城市 *i + 1*。

在 *1* 到 *N-1* 之间的每个城市，你都可以选择在等待下一班巴士之前花费 *T_s* 时间观光城市或者选择直接等待下一班巴士。

你不能在同一个城市观光多次，上下巴士的时间可以忽略不计。

你必须最迟在 *T_f* 时刻到达 *N* 市。 （请注意，即使你提前到达，你也不能去 *N* 市观光。那里没什么可看的！）

请问你可以观光的最大城市数量是多少？

### 输入格式

第一行包含整数 *T*，表示共有 *T* 组测试数据。

每组数据第一行包含三个整数 *N*,*T_s*,*T_f*，分别表示城市数量，观光城市所需时间以及抵达城市 *N* 的最后期限时间。

接下来 *N-1* 行，第 *i* 行包含三个整数 *S_i,F_i,D_i*，表示城市 *i* 到城市 *i+1* 的巴士始发时间，发车间隔，持续乘车时间。

### 输出格式

每组数据输出一个结果，每个结果占一行。

结果表示为 `Case #x: y`，其中 *x* 为组别编号（从 *1* 开始），*y* 是你可以去观光的最大城市数，如果无论如何都不能按规定时间抵达城市 *N*，则 *y* 为 `IMPOSSIBLE`。

### 数据范围

*1 ≤ T ≤ 100*,

*2 ≤ N ≤ 2000*,

*1 ≤ S_i,F_i,D_i,T_s,T_f ≤ 10^9*

### 输入样例：

```
4
4 3 12
3 2 1
6 2 2
1 3 2
3 2 30
1 2 27
3 2 1
4 1 11
2 1 2
4 1 5
8 2 2
5 10 5000
14 27 31
27 11 44
30 8 20
2000 4000 3
```

### 输出样例：

```
Case #1: 2
Case #2: 0
Case #3: IMPOSSIBLE
Case #4: 4
```

### 样例解释

在第一个样例中，你可以在 *1* 号城市观光，然后在时刻 *3* 乘坐巴士，于时刻 *4* 到达 *2* 号城市。然后在 *2* 号城市观光，在时刻 *8* 乘坐巴士于时刻 *10* 抵达 *3* 号城市，然后立即登上下一班巴士，并在时刻 *12* 赶到 *4* 号城市。
