## [542. 国王的巡回](https://www.acwing.com/problem/content/544/)

### 题目

Kickstartia 王国在新国王的加冕日举办了盛大的庆祝活动。

按照加冕典礼的惯例，皇家游行将在首都的街道上行进。

首都可以被认为是一个无限大的 *2D* 平面，在水平和垂直方向都有着无限数量的间隔一米的无限长的街道。

水平街道从上到下标记为负无穷大到无穷大，而垂直街道从左到右标记为负无穷大到无穷大。

首都有 *N* 家咖啡馆，第 *i* 家咖啡馆位于垂直街道 *V_i* 和水平街道 *H_i* 的交汇处。

没有两家咖啡馆坐落在同一个十字路口。

为了让游行技术人员能够保持精力充沛，你要选择其中三家咖啡馆供他们沿途休息。

为了保证游行的秩序不出现混乱，游行最终需要回到出发点，并且游行穿过街道的路径必须是正方形的形状。

你挑选的三座咖啡馆需要坐落在正方形的游行路线中。

这就出现了一个问题：在你选定三座咖啡馆后，可能并不存在一条正方形游行路线，使得这三个咖啡馆都在游行路线上。

所以，你的任务是找出：有多少不同的三个咖啡馆的组合，满足至少存在一条正方形游行路线，使得这三个咖啡馆都在游行路线上？

如果两个咖啡馆组合包含的咖啡馆不完全相同，则认为是两种不同的组合。

### 输入格式

第一行包含整数 *T*，表示共有 *T* 组测试数据。

每测试数据由一行组成，包含十个整数 *N*，*V_1*，*H_1*，*A*，*B*，*C*，*D*，*E*，*F* 和 *M*。

其中 *N* 为咖啡馆的数量，第一个咖啡馆坐落于垂直街道 *V_1* 和水平街道 *H_1* 的交汇处。

其他咖啡馆（第 *2* 个至第 *N* 个）的位置参数 *V_i*、*H_i* 可以用下列式子生成：

*V_i = (A × V_{i-1} + B × H_{i-1} + C) bmod M *

*H_i = (D × V_{i-1} + E × H_{i-1} + F) bmod M *

### 输出格式

每组数据输出一个结果，每个结果占一行。

结果表示为 `Case #x: y`，其中 *x* 为组别编号（从 *1* 开始），*y* 是满足上述条件的咖啡馆组合的数量。

### 数据范围

*1 ≤ T ≤ 100*,

*0 ≤ A,B,C,D,E,F,V_1,H_1 < M*,

对于所有 *i ≠ j*,满足 *(V_i,H_i) ≠ (V_j,H_j)*，

*3 ≤ N ≤ 1000*,

*2 ≤ M ≤ 1000*

### 输入样例：

```
3
4 1 1 4 1 1 4 2 4 5
6 3 1 1 0 1 0 1 0 9
3 7 24 34 11 17 31 15 40 50
```

### 输出样例：

```
Case #1: 3
Case #2: 20
Case #3: 0
```

### 样例解释

以样例 *1* 为例，共有四个咖啡馆，它们位于 *(1,1),(1,0),(0,3)* 和 *(4,0)*。

其中组合 *(1,1),(1,0),(0,3)* 或 *(1,1),(1,0),(4,0)* 或 *(1,0),(0,3),(4,0)* 可以满足条件，如下图所示。

 ![QQ截图20190327160846.png](https://cdn.acwing.com/media/article/image/2019/03/27/19_926cd94850-QQ截图20190327160846.png)
