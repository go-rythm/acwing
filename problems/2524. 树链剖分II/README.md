## [2524. 树链剖分II](https://www.acwing.com/problem/content/2526/)

### 题目

给定一棵树，树中包含 *n* 个节点（编号 *1 ~ n*），其中第 *i* 个节点的权值为 *a_i*。

初始时，*1* 号节点为树的根节点。

现在要对该树进行 *m* 次操作，操作分为以下 *5* 种类型：

- `1 u`，换根，将节点 *u* 设为新的树根。
- `2 u v k`，修改路径上节点权值，将节点 *u* 和节点 *v* 之间路径上的所有节点（包括这两个节点）的权值增加 *k*。
- `3 u k`，修改子树上节点权值，将以节点 *u* 为根的子树上的所有节点的权值增加 *k*。
- `4 u v`，询问路径，询问节点 *u* 和节点 *v* 之间路径上的所有节点（包括这两个节点）的权值和。
- `5 u`，询问子树，询问以节点 *u* 为根的子树上的所有节点的权值和。

### 输入格式

第一行包含一个整数 *n*，表示节点个数。

第二行包含 *n* 个整数，其中第 *i* 个整数表示 *a_i*。

第三行包含 *n-1* 个整数，其中第 *i* 个整数表示第 *i+1* 号节点的父节点编号。

第四行包含一个整数 *m*，表示操作次数。

接下来 *m* 行，每行包含一个操作，格式如题目所述。

### 输出格式

对于每个操作 *4* 和操作 *5*，输出一行一个整数表示答案。

### 数据范围

*1 ≤ n,m ≤ 10^5*,

*0 ≤ a_i,k ≤ 10^5*,

*1 ≤ u,v ≤ n*

### 输入样例：

```
6
1 2 3 4 5 6
1 2 1 4 4
6
4 5 6
2 2 4 1
5 1
1 4
3 1 2
4 2 5
```

### 输出样例：

```
15
24
19
```
