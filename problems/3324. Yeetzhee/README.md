## [3324. Yeetzhee](https://www.acwing.com/problem/content/3327/)

### 题目

Pommel 在家非常无聊，所以她发明了一个新游戏，需要用到 *N* 个骰子。

每个骰子都有 *M* 面，依次标有数字 *1 ~ M*。

每当她掷出一个骰子时，任何一个数字朝上的概率都相等。

Pommel 将所有骰子排成一排。

她从左到右每次掷一个骰子。

对于她掷出的每一个骰子，Pommel 既可以保留其掷出的数值，然后准备掷下一个骰子，也可以选择重新掷该骰子。

Pommel 在准备掷下一个骰子之前，可以选择重掷当前的骰子任意多次，直到自己满意为止。

一旦 Pommel 掷完了所有的骰子，游戏就结束了。

为了确定自己是否获胜，她将骰子进行分组，所有掷出相同值的骰子分在同一组中。

因此，如果她最终掷出了 *X* 个不同的数值，则将会有 *X* 组。

然后，将这些组按照组内骰子数量以非降序进行排序。

例如：

- 如果最终骰子的结果是 *[2,2,3,2,2,3]*，那么骰子将被分为两组，并按照如下顺序排序：*[3,3]* 和 *[2,2,2,2]*。
- 如果最终骰子的结果是 *[1,6,7,7]*，那么骰子将被分为三组，并按照如下顺序排序：*[6]*，*[1]* 和 *[7,7]*（或者，等价地，*[1]*，*[6]* 和 *[7,7]*）。

如果在投完所有骰子之后，能够将骰子恰好分成 *K* 组，且第 *i* 组恰好包含 *A_i* 个骰子，那么就认为 Pommel 获胜了。

请问 Pommel 想要获胜所需要掷骰子的总次数的期望值是多少，假设她会采取最佳策略以最小化这个期望值。

保证，对于任何有效的输入，Pommel 都有可能获胜。

### 输入格式

第一行包含整数 *T*，表示共有 *T* 组测试数据。

每组数据第一行包含三个整数 *N,M,K*。

接下来 *K* 行，每行包含一个整数 *A_i*，表示第 *i* 组骰子应当包含的骰子数量。

### 输出格式

每组数据输出一个结果，每个结果占一行。

结果表示为 `Case #x: y`，其中 *x* 为组别编号（从 *1* 开始），*y* 为获胜所需要掷骰子的总次数的期望值。

*y* 在正确答案的 *10^{−6}* 的绝对或相对误差范围内，则视为正确。

### 数据范围

*1 ≤ T ≤ 100*,

*1 ≤ K ≤ M*,

*1 ≤ A_i*,

*A_1+A_2+…+A_K=N*,

*A_i ≤ A_{i+1}*,

*2 ≤ N,M ≤ 50*

### 输入样例：

```
2
3 6 2
1
2
5 2 1
5
```

### 输出样例：

```
Case #1: 4.7
Case #2: 9.0
```

### 样例解释

对于测试数据 *1*，共有 *N=2* 个骰子，每个骰子上有 *M=6* 个数字。

为了获胜，她需要将骰子最终分成两组，一组有 *A_1=1* 个骰子，另一组有 *A_2=2* 个骰子。

一种最佳策略如下：

- 投掷第一个骰子一次。
- 投掷第二个骰子一次。
- 有 *frac16* 的概率前两个骰子掷出的数值相同，此时不断投掷第三个骰子，使得其值与前两个不同即可，掷出不同值的概率为 *frac56*，期望投掷次数为 *1.2* 次。
- 有 *frac56* 的概率前两个骰子掷出的数值不同，此时不断投掷第三个骰子，使得其值与前两个中任意一个相同即可，掷出相同值的概率为 *frac13*，期望投掷次数为 *3* 次。

此策略平均需要掷出 *4.7 (1 + 1 + frac16 × 1.2 + frac56 × 3)* 次骰子。

对于测试数据 *2*，共有 *N=5* 个骰子，每个骰子上有 *M=2* 个数字。

为了获胜，她需要将骰子最终分成一组，*5* 个骰子。

首先，投掷第一个骰子一次，然后接下来的四个骰子都不断投掷到与第一个骰子数值相同为止，平均每个骰子需要投掷两次。

此策略平均需要掷出 *9 (1 + 2 + 2 + 2 + 2)* 次骰子。
