## [2138. 公路修建问题](https://www.acwing.com/problem/content/2140/)

### 题目

*OI* 岛是一个非常漂亮的岛屿，自开发以来，到这儿来旅游的人很多。

然而，由于该岛屿刚刚开发不久，所以那里的交通情况还是很糟糕。

因此，*OI* 协会组织成立了，该组织旨在建立 *OI* 岛的交通系统。

*OI* 岛有 *n* 个旅游景点，不妨将它们从 *1* 到 *n* 标号。

现在，*OI* 协会需要修公路将这些景点连接起来。

一条公路连接两个景点。

公路有两种，不妨称它们为一级公路和二级公路。

一级公路上的车速快，但是修路的花费要大一些。

*OI* 协会打算修 *n-1* 条公路将这些景点连接起来（使得任意两个景点之间都会有一条路径）。

为了保证公路系统的效率，*OI* 协会希望在这 *n-1* 条公路之中,至少有 *k* 条一级公路。

*OI* 协会也不希望为一条公路花费过多的钱。

所以，他们希望在满足上述条件的情况下，花费最多的一条公路的花费尽可能的少。

而你的任务就是，在给定一些可能修建的公路的情况下，选择 *n-1* 条公路，满足上面的条件。

### 输入格式

第一行有三个数 *n,k,m*，这些数之间用空格分开。*n* 和 *k* 如前所述，*m* 表示有 *m* 对景点之间可以修公路。

以下的 *m* 行，每一行有 *4* 个正整数 *a,b,c_1,c_2*。表示在景点 *a* 与 *b* 之间可以修公路，如果修一级公路，则需要 *c_1* 的花费，如果修二级公路，则需要 *c_2* 的花费。

### 输出格式

第一行有一个数据，表示花费最大的公路的花费。

接下来的 *n-1* 行，每一行有两个正整数 *t,p*，描述一条修建的公路。 *t* 和 *p* 表示在输入的第 *t* 对（按照输入的顺序，从 *1* 开始标号）景点之间修建 *p* 级公路。

*n-1* 条公路的输出必须按照 *t* 的大小递增。

如果有多个方案使花费最大的公路花费最小，输出任意一个都可以。

### 数据范围

*1 ≤ n ≤ 10000*,

*0 ≤ k ≤ n-1*,

*n-1 ≤ m ≤ 20000*,

*1 ≤ a,b ≤ n*,

*a ≠ b*,

*1 ≤ c_2 ≤ c_1 ≤ 30000*,

*1 ≤ t ≤ m*,

*1 ≤ p ≤ 2*

### 输入样例1：

```
4 2 5
1 2 6 5
1 3 3 1
2 3 9 4
2 4 6 1
3 4 4 2
```

### 输出样例1：

```
4
2 1
3 2
5 1
```

### 输入样例2：

```
4 1 5
1 2 6 5
1 3 3 1
2 3 9 4
2 4 6 1
3 4 4 3
```

### 输出样例2：

```
3
2 1
4 2
5 2
```
