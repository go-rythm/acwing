## [559. 整合班级](https://www.acwing.com/problem/content/561/)

### 题目

Supervin 正在教授 *N* 个班级，编号从 *1* 到 *N*。

在最近一次考试结束之后，他注意到在他的所有班级里，班内同学的成绩都能够构成一系列连续的整数。

因此，Supervin 可以将第 *i* 个班级的分数总结为两个整数 *L_i* 和 *R_i*。

这意味着第 *i* 个班级有 *R_i-L_i + 1* 个学生，学生们的成绩从小到大依次为 *L_i,L_i+1,L_i+2,…,R_i*。

Supervin 希望将他所有班级的学生的分数整合在一起，并按非递增顺序对分数进行排序。

他对于这份整理好的成绩单存在 *Q* 个问题（从 *1* 到 *Q* 编号）;第 *i* 个问题的内容是，排在第 *K_i* 名的学生的分数是多少。 （如果 *K_i* 大于学生人数，则第 *i* 个问题的答案为 *0*。）

你能帮助 Supervin 回答他的所有问题吗？

为了简化输出，你并不需要输出所有问题的具体答案，你需要输出：

** sum_{i=1}^Q S_i × i **,其中 *S_i* 是第 *i* 个问题的答案。

### 输入格式

第一行包含整数 *T*，表示共有 *T* 组测试数据。

每组测试数据包含四行，其中第一行包含整数 *N* 和 *Q*。

接下来三行，以如下格式每行包含 *6* 个整数：

*X_1 X_2 A_1 B_1 C_1 M_1*

*Y_1 Y_2 A_2 B_2 C_2 M_2*

*Z_1 Z_2 A_3 B_3 C_3 M_3*

这些值用于生成 *L_i,R_i,K_i*，如下所示：

首先我们定义：

*X_i = (A_1 × X_{i - 1} + B_1 × X_{i - 2} + C_1) bmod M_1, (3 ≤ i ≤ N)*

*Y_i = (A_2 × Y_{i - 1} + B_2 × Y_{i - 2} + C_2) bmod M_2, (3 ≤ i ≤ N)*

*Z_i = (A_3 × Z_{i - 1} + B_3 × Z_{i - 2} + C_3) bmod M_3, (3 ≤ i ≤ Q)*

然后我们定义：

*L_i = min(X_i, Y_i) + 1, (1 ≤ i ≤ N)*

*R_i = max(X_i, Y_i) + 1, (1 ≤ i ≤ N)*

*K_i = Z_i + 1, (1 ≤ i ≤ Q)*

### 输出格式

每组数据输出一个结果，每个结果占一行。

结果表示为 `Case #x: y`，其中 *x* 为组别编号（从 *1* 开始），*y* 为题目描述中的输出。

### 数据范围

*1 ≤ T ≤ 100*,

*1 ≤ N ≤ 4*10^5*,

*0 ≤ A_i,B_i,C_i < M_i*,

*0 ≤ X_1,X_2 < M_1*,

*0 ≤ Y_1,Y_2 < M_2*,

*0 ≤ Z_1,Z_2 < M_3*,

*1 ≤ M_i ≤ 10^9*，

*1 ≤ Q ≤ 10^5*

### 输入样例：

```
3
5 1
3 1 4 1 5 9
2 7 1 8 2 9
4 8 15 16 23 42
5 5
3 1 4 1 5 9
2 7 1 8 2 9
4 8 15 16 23 42
1 2
0 0 0 0 0 1
0 0 0 0 0 1
0 1 0 0 0 2
```

### 输出格式

```
Case #1: 7
Case #2: 39
Case #3: 1
```

### 样例解释

在样例＃1中，生成的 *X，Y，Z* 数列为：

*X = [3,1,3,0,8]*

*Y = [2,7,7,2,6]*

*Z = [4]*

由此求得：

*L = [3,2,4,1,7]*

*R = [4,8,8,3,9]*

*K = [5]*

每个班级的学生成绩分别为 *[3,4]，[2,3,4,5,6,7,8]，[4,5,6,7,8]，[1,2,3] ，[7,8,9]*。

这意味着所有班级的学生成绩分别为 *[3,4,2,3,4,5,6,7,8,4,5,6,7,8,1,2,3,7,8,9]*。

如果我们按非递增顺序排序，它们是 *[9,8,8,8,7,7,7,6,6,5,5,4,4,4,3,3,3,2,2,1]*。

由此可得，成绩排在第 *5* 的学生得分为 *7*。

*S = [7]*，答案为 *7×1 = 7*。

在样例＃2中，除了 *Q* 的值之外，其它参数都与样例＃1相同，因此，*L* 和 *R* 的值以及所有班级的学生分数仍然与样例＃1相同。

现在的 *K = [5,9,40,23,12]*。

成绩排在第 *5*，第 *9* 和第 *12* 的学生的得分为 *7* 分，*6* 分和 *4* 分。

由于只有 *20* 名学生，所以不存在第 *23* 名和第 *40* 名。

因此，*S = [7,6,0,0,4]*，答案是 *7×1 + 6×2 + 0×3 + 0×4 + 4×5 = 7 + 12 + 20 = 39*。
