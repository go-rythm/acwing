## [3309. 树之美](https://www.acwing.com/problem/content/3312/)

### 题目

Amadea 和 Bilva 正在装饰一棵包含 *N* 个节点（从 *1* 到 *N* 标记）的有根树。

节点 *1* 是这棵树的根节点，其它所有节点都有一个更小数字标号的父节点。

Amadea 和 Bilva 按照如下方式装饰这棵树：

- Amadea 随机均匀的挑选树中的一个节点，并将其着色。然后从该节点开始沿着树向上走，直到根节点为止，每到达的第 *A* 个节点也将被她着色。
- Bilva 随机均匀的挑选树中的一个节点，并将其着色。然后从该节点开始沿着树向上走，直到根节点为止，每到达的第 *B* 个节点也将被她着色。

一棵树的美丽值等于被着色的节点（被任意一人着色即可）的数量。

注意，即使某个节点同时被两个人着色，那么它也只应被计数一次。

请问，这棵树的期望美丽值是多少？

### 输入格式

第一行包含整数 *T*，表示共有 *T* 组测试数据。

每组数据第一行包含三个整数 *N,A,B*。

第二行包含 *N-1* 个整数，其中的第 *i* 个整数是节点 *i+1* 的父节点标号。

### 输出格式

每组数据输出一个结果，每个结果占一行。

结果表示为 `Case #x: y`，其中 *x* 为组别编号（从 *1* 开始），*y* 为树的期望美丽值。

*y* 在正确答案的 *10^{−6}* 的绝对或相对误差范围内，则视为正确。

### 数据范围

*1 ≤ T ≤ 100*,

*1 ≤ A,B ≤ N*,

对于每个测试点，满足 *1≤N≤5×10^5* 的数据一定不超过 *5* 组，其余数据则满足 *1≤N≤100*。

### 输入样例：

```
3
8 2 3
1 1 3 4 4 3 4
10 3 4
1 1 1 1 1 1 1 1 1
4 3 1
1 2 3
```

### 输出样例：

```
Case #1: 2.65625
Case #2: 1.9
Case #3: 2.875
```

### 样例解释

每组数据包含的树如下所示：

 ![QQ截图20210324143703.png](https://cdn.acwing.com/media/article/image/2021/03/24/19_6eb2f9658c-QQ截图20210324143703.png)

测试数据 *1* 的一些示例着色如下：

- 如果 Amadea 选择节点 *5*，Bilva 选择节点 *8*，则共 *4* 个节点被着色：Amadea 给节点 *5* 和 *3* 着色，而 Bilva 给节点 *8* 和 *1* 着色。
- 如果 Amadea 选择节点 *7*，Bilva 选择节点 *6*，则共 *3* 个节点被着色：Amadea 给节点 *7* 和 *1* 着色，而 Bilva 给节点 *6* 和 *1* 着色（注意节点 *1* 不能重复计数）。

 ![QQ截图20210324143735.png](https://cdn.acwing.com/media/article/image/2021/03/24/19_72c40ea88c-QQ截图20210324143735.png)
