## [3519. 池化](https://www.acwing.com/problem/content/3522/)

### 题目

北京大学“新工程技术学科”建设如火如荼，计算机科学新工程建设是其中的重要组成部分。

刚刚开始自己在北京大学信息科学技术学院的学习生活的李毅同学也深受感染。

大一是学习基础课程的最佳时期，对他来说，学好这些课程是参与到新工程建设的最佳方式。

于是，他选修了“人工智能概论”这一课程，决心在这门课程中开始学习机器学习。

今天，他学习了卷积神经网络（CNN），但对 CNN 的一个基本操作感到困惑，这个操作被称为 **池化**。

他已经学习了两种池化操作，最大值池化和平均池化。

最大值池化：给定一个 *n × n* 的矩阵 *A*，池化层的大小为 *k*（*k* 是 *n* 的因子）。在最大值池化后，我们可以得到一个新的 *frac{n}{k} × frac{n}{k}* 的矩阵 *B*（不妨用 *M(i,j)* 来表示一个矩阵 *M* 的第 *i* 行第 *j* 列的元素）：

**B(i,j)=max_{(i-1)× k+1 ≤ p ≤ i × k,(j-1) × k+1 ≤ q ≤ j × k}⁡{A(p,q)}**

对于以下给定矩阵：

```
0 1 2 3
4 5 6 7
8 9 10 11
12 13 14 15
```

如果 *k=2*，我们可以得到：

```
5 7
13 15
```

平均池化：给定一个 *n × n* 的矩阵 *A*，池化层的大小为 *k*（*k* 是 *n* 的因子）。在平均池化后，我们可以得到一个新的 *frac{n}{k} × frac{n}{k}* 的矩阵 *C*：

**C(i,j)=frac{sum_{(i-1)× k+1≤p≤itimes k,(j-1)× k+1≤q≤jtimes k)} A(p,q)}{ktimes k}**

对于先前给定的矩阵，在 *k=2* 时，平均池化后可得到：

```
2.5 4.5
10.5 12.5
```

然而，留给他的作业有一点难。

基于以上两个池化操作和 CNN 的卷积运算，老师布置了以下作业：

对于一个 *n × n* 的矩阵 *A*，给定 *ksize* 和 *stride*（*n-ksize* 能被 *stride* 整除），请你求出 *((n-ksize)/stride+1) × ((n-ksize)/stride+1)* 的矩阵 *B* 和 *C*，其定义如下：

**

B(i,j)=max_{1≤p,q≤ksize}{A((i-1)×stride+p,(j-1)×stride+q)}

**

**

C(i,j)=frac{sum_{1≤p,q≤ksize}A((i-1)×stride+p,(j-1)×stride+q)}{ksize^2}

**

这个问题把李毅搞糊涂了，你能帮帮他吗？

### 输入格式

输入共 *n+1* 行。

第一行包含三个整数 *n,ksize,stride*。

第 *i+1* 行，包含 *n* 个用单个空格隔开的整数，其中第 *j* 个整数是 *A(i,j)*。

### 输出格式

因为矩阵 *B* 和 *C* 的数据量过大，我们换一种方式输出。

输出共包含 *2 × ((n-ksize)/stride+1)* 行。

对于前 *(n-ksize)/stride+1* 行，第 *i* 行只包含一个数字，等于 *sum B_{i,j}×39^{j-1}* 对 *998244353* 取模。

对于后 *(n-ksize)/stride+1* 行，第 *i* 行只包含一个数字，等于 *sum C_{i,j}× ksize^2times 37^{j-1}* 对 *1000000007* 取模。

### 数据范围

*1≤n≤1000*,

*1≤ksize,stride≤n*,

*(n-ksize)* 保证能被 *stride* 整除,

*1≤A(i,j)≤10^9*

### 输入样例：

```
4 3 1
0 1 2 3
4 5 6 7
8 9 10 11
12 13 14 15
```

### 输出样例：

```
439
599
2043
3411
```

### 样例解释

矩阵 *B* 为：

```
10 11
14 15
```

矩阵 *C* 为：

```
5 6
9 10
```
