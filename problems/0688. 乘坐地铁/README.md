## [688. 乘坐地铁](https://www.acwing.com/problem/content/690/)

### 题目

某个城市的地铁系统是这样的：

- 该市有 *N* 条地铁线：*1* 号线，*2* 号线，......，*N* 号线。
- 对于每条地铁线路 *i*，都有 *SN_i* 站。假设它们是 *S_{i,1},S_{i,2}, … , S_{i,SN_i}*。这些站按线路位置顺序排序，且地铁两个方向都在运行。换句话说，地铁共有两个线路 *S_{i,1} -> S_{i,2} -> … -> S_{i,SN_i}* 和 *S_{i,SN_i} -> S_{i,SN_{i-1}} -> … -> S_{i,1}*。你可以从任何车站乘坐地铁，在任何车站下车。从一个车站到下一个车站需要一段时间。从 *S_{i,1}* 站到 *S_{i,2}* 站需要花费 *Time_{i,1}* 分钟，从 *S_{i,2}* 站到 *S_{i,3}* 站需要花费 *Time_{i,2}* 分钟，以此类推。在另一个方向从一站到另一站花费的时间相同。
- 有 *M* 个转线隧道。每条转线隧道连接两个不同地铁线路的站点。从任何一个方向穿过隧道都需要一定的时间。你可以在位于隧道一端的车站下车，然后穿过隧道到达另一端的车站。
- 当你抵达 *i* 线的某个地铁站时，你需要花费 *W_i* 分钟等待下一班地铁的到来。

现在，你将从一个车站出发前往另一个车站。

请你计算出你所需的最短时间是多少。

### 输入格式

第一行包含整数 *T*，表示共有 *T* 组测试数据。

每组数据第一行包含整数 *N*，表示地铁线路数量。

每条地铁线路用两行描述，第一行包含整数 *SN_i* 和 *W_i*，表示站点数量以及等车时间。

描述完所有地铁线路后，下一行包含整数 *M*，表示隧道数量。

接下来 *M* 行，每行包含五个整数 *m1_i, s1_i, m2_i, s2_i, t_i*，表示站点 *S_{m1_i,s1_i}* 和站点 *S_{m2_i,s2_i}* 之间存在一条隧道，且穿越隧道需要花费 *t_i* 分钟。

接下来一行包含整数 *Q*，表示问题数量。

接下来 *Q* 行，每行包含四个整数 *x_1, y_1, x_2, y_2*，表示你需要从车站 *S_{x_1,y_1}* 出发前往车站 *S_{x_2,y_2}*。

### 输出格式

对于每组测试数据，第一行输出 `Case #x:`，其中 *x* 为组别编号（从 *1* 开始）。

接下来 *Q* 行，每行输出一个问题的答案。

如果某个问题中涉及的两个车站之间不存在行进路线，则输出 *-1*。

### 数据范围

*1 ≤ T ≤ 100*,

*1 ≤ W_i,Time_{i,j},t_i ≤ 100*,

*1 ≤ m1_i ≤ N*,

*1 ≤ s1_i ≤ SN_{m1_i}*,

*1 ≤ m2_i ≤ N*,

*1 ≤ s2_i ≤ SN_{m2_i}*,

*m1_i ≠ m2_i*,

*1 ≤ Q ≤ 10*,

*1 ≤ x1 ≤ N*,

*1 ≤ y1 ≤ SN_{x1}*,

*1 ≤ x2 ≤ N*,

*1 ≤ y2 ≤ SN_{x2}*,

*S_{x1,y1} ≠ S_{x2,y2}*,

*1 ≤ N ≤ 100*,

*0 ≤ M ≤ 100*,

*2 ≤ SN_i ≤ 1000*,

每组数据中的站点总数均不超过 *1000*。

### 输入样例：

```
2

2
5 3
3 5 7 3
4 2
1 1 1
1
1 2 2 2 1
1
1 1 2 4

2
5 3
3 5 7 3
4 2
1 1 1
2
1 2 2 2 1
2 4 1 4 1
1
1 1 1 5
```

### 输出样例：

```
Case #1:
11
Case #2:
18
```

### 样例解释

在样例#1中，你将从地铁 *1* 号线的 *1* 号站前往地铁 *2* 号线的 *4* 号站。

最好的方法是：

- 在 *1* 号线等待 *3* 分钟然后上地铁。
- 花 *3* 分钟到达 *2* 号站并下车。
- 走隧道，步行 *1* 分钟到 *2* 号线的 *2* 号站。
- 在 *2* 号线等待 *2* 分钟然后上地铁。
- 花 *2* 分钟到达 *4* 号站并下车。

总时间花费为：*3 + 3 + 1 + 2 + 2 = 11* 分钟。
