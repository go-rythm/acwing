## [2000. 平衡树](https://www.acwing.com/problem/content/2002/)

### 题目

到目前为止，农夫约翰对平衡括号仍然非常着迷，他想知道你是否能帮他解决最后一个问题。

事实证明，约翰的农场是一棵由 *N* 个牧场组成的巨树。

每个牧场上他都标注了 `(` 或 `)`。

例如：

```
'('--'('--')'--'('--')'
|         |
')'       ')'--'('--'('
|              |
')'            '('--')'--')'--')'--'('
```

回想一下，因为他的农场是一棵树，这意味着某些牧场是通过走廊连接的，因此在任何给定的牧场之间都有一条唯一的路径。

约翰认为其中一些路径代表了平衡括号字符串。

特别是，他想知道在所有通过树的路径表示的平衡括号字符串中，可以找到的最大嵌套深度是多少。

平衡括号字符串的嵌套深度是该字符串的所有前缀中，前缀内多余 `(` 的个数的最大值。

例如，字符串 `()()()` 的嵌套深度为 *1*，而字符串 `((()))()` 的嵌套深度为 *3*，因为我们可以清楚的数出每个前缀内多余 `(` 的数量：

```
((()))()
12321010
```

对于上面的示例农场，最深的字符串为 `((()))`，深度为 *3*，可以通过以下从 *A* 到 *B* 的路径获得：

```
'('--'('--')'--'('--')'
|         |
')'       ')'--'('--'(' < A
|              |
')'            '('--')'--')'--')'--'('
^C                            ^B
```

请注意，这不一定是最长的平衡字符串，例如从 *A* 到 *C* 获得的字符串 `(())(())` 的长度为 *8*。

你的任务是输出树中最深平衡路径的嵌套深度。

### 输入格式

第 *1* 行：一个整数 *N*，表示树中节点数量。

第 *2..N* 行：第 *i+1* 行包含一个整数 *p_{i+1}*，表示节点 *i+1* 和 *p_{i+1}* 之间存在一条边。

第 *N+1..2N* 行：第 *N+i* 行包含一个 `(` 或 `)`，表示节点 *i* 上的标注。

### 输出格式

输出平衡路径的最大嵌套深度。

### 数据范围

*1 ≤ N ≤ 40000*,

*1 ≤ p_{i+1} ≤ i*

### 输入样例：

```
15
1
2
1
4
4
6
7
5
9
9
11
12
13
14
(
)
)
(
)
)
(
)
(
(
(
)
)
)
(
```

### 输出样例：

```
3
```
