## [3525. 游戏](https://www.acwing.com/problem/content/3528/)

### 题目

*n* 个人站成一排玩一个游戏，每个人头上都戴了一顶帽子，帽子的颜色要么是黑的，要么是白的，每个人都知道戴黑帽子的人的数量和戴白帽子的人的数量。

这 *n* 个人从前往后编号为 *1…n*，每个人都在向前看，由于身高等原因，每个人并不一定能看到他前面所有人戴的帽子，对于第 *i* 个人来说，他只能看到编号从 *l[i]* 到 *i-1* 的人头上帽子的颜色。

所有人都知道每个人的视野大小，即 *l[i]*，每个人的目标是利用当前已知的信息猜出自己头上帽子的颜色。

游戏分为若干轮，每轮所有人同时报出自己能不能猜出自己头上帽子的颜色，如果所有人都不能猜出，那么继续开始下一轮。

如果有人猜出，游戏就结束了。

你处于上帝视角，知道每个人头上帽子的颜色，请你推断出游戏会进行多少轮，和最终有哪些人猜出了自己头上帽子的颜色。

### 输入格式

第一行一个正整数 *n*，表示人数。

第二行 *n* 个正整数 *l[i]*，表示每个人能看到的最前面的人，可能有人一个人都看不见。

第三行一个长度为 *n* 的 *01* 串 *s*，第 *i* 个字符如果是 *0* 表示编号为 *i* 的人头上戴的帽子是白色的，如果是 *1* 表示编号为 *i* 的人头上戴的帽子是黑色的。

### 输出格式

如果游戏永远不会结束，输出 *-1*。

如果游戏能结束，第一行输出游戏进行的轮数。

第二行输出最终猜出自己头上的帽子的颜色的人的编号，输出按照编号从小到大的顺序。

### 数据范围

*1 ≤ N ≤ 5 × 10^5*,

*1 ≤ l[i] ≤ i*

### 输入样例：

```
4
1 2 2 2
0101
```

### 输出样例：

```
2
3
```

### 样例解释

第一轮没有人能猜出自己头上帽子的颜色，考虑如果 *4* 号第一轮没有猜出，那么 *2* 号和 *3* 号必然不同色，那么在第二轮 *3* 号就能猜出自己头上的帽子是白色的，其他人还是猜不出来，所以游戏一共进行了 *2* 轮，只有 *3* 号猜出了自己头上帽子的颜色。
