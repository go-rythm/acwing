## [2386. 蔬菜庆典](https://www.acwing.com/problem/content/2388/)

### 题目

jyy 在火星上找到一片埋有宝藏的岛，并且带走了一些宝藏。

之后…jyy 被火星人发现偷宝藏，抓了起来。

火星人打算吃掉 jyy，除非 jyy 能在火星年度蔬菜庆典的游戏中赢得足够多的火星币，来支付他带走宝藏的费用。

游戏在蔬菜广场上进行。

首先放进广场的是一个巨大的转基因南瓜，接着各种其他巨大的蔬菜被陆续拖进广场，连同大南瓜一共 *N* 个。

方便起见，我们把蔬菜按照放入广场的时间顺序从 *1..N* 编号。

第 *i* 个放入的蔬菜会用一根绳子和先前放入的某个蔬菜 *p_i* 连接起来。

按照火星人的说法，蔬菜 *i* 是蔬菜 *p_i* 的 Dlihc，蔬菜 *p_i* 是蔬菜 *i* 的 Tnerap。

jyy 立即看出，一开始的大南瓜没有 Tnerap，后来的每个蔬菜都恰好有一个 Tnerap；每个蔬菜可能有一个或多个 Dlihc，也可能没有。

*N* 个蔬菜全部在广场上安置好后，火星人在每个蔬菜上贴一张纸条，蔬菜 *i* 的纸条上写着一个整数 *v_i*，表示这个蔬菜的价钱。

游戏一个接一个地进行着。

在整个晚会将要结束时， jyy 终于等到了适合自己的那一个(你不能指望有恐高症的 jyy 会在蔬菜间玩走钢丝，尽管那样能有丰厚的报酬)。

游戏规则是：游戏者(也就是 jyy 啦）每次可以选择任息一个既有 Dlihc 又有 Tnerap 的蔬菜 *i*，将它的价钱 *v_i* 改为 *v_p+v_c-v_i*。

其中 *p* 表示蔬菜 *i* 的 Tnerap 的编号，*c* 表示蔬菜 *i* 的任意一个 Dlihc 的编号。

火星人给的时间比较宽裕，足够 jyy 进行任意多次操作。

当 jyy 决定不再操作时，游戏结束。

之后所有巨型蔬菜将被火星政府按蔬菜上的标价收购，卖菜所得的钱归 jyy 所有，用以支付他的债务。

jyy 想知道，他最多能把这些蔬菜卖出多少钱，或者他能通过一系列操作使得蔬菜的总价无限制地增大。

请你帮助 jyy 解决这个问题。

### 输入格式

输入包含多组数据。

每组数据的格式为:

第 *1* 行是一个整数 *N* ，表示广场上蔬菜的总个数。

第 *2..N+1* 行，每行两个整数，第 *i＋1* 行的两个整数为 *p_i,v_i*，意义如题中所述。

*p_1* 设为 *-1*。

当 *N=0* 时，表示输入结束。

### 输出格式

对于每组数据，输出一行。

若蔬菜的总价能无限制增大，输出 `+inf`。

否则输出一个整数，表示所有蔬菜的最大总价。

### 数据范围

*1 ≤ N ≤ 2 × 10^5*,

*1 ≤ p_i < i*,

*-10^7 ≤ v_i ≤ 10^7*,

保证每个测试点中 *N* 的总和不超过 *200,000*。

### 输入样例：

```
5
-1 3
1 2
1 1
3 2
3 2
5
-1 3
1 2
1 1
3 2
3 3
0
```

### 输出样例：

```
13
+inf
```

### 样例解释

共有 *2* 组数据。

对第一组数据，我们只能对蔬菜 *3* 进行操作，它的值只能是 *1* 或 *4*。

于是答案为 *3+2+4+2+2=13*。

对第二组数据，我们可以按下面的方法不断地操作蔬菜 *3*，使得总和无限制地增大。

*1 to 3+3-1 = 5*

*5 to 3+2-5 = 0*

*0 to 3+3-0 = 6*

*6 to 3+2-6 =-1*

*-1 to 3+3-(-1)= 7*
