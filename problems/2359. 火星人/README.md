## [2359. 火星人](https://www.acwing.com/problem/content/2361/)

### 题目

火星人最近研究了一种操作：求一个字串两个后缀的公共前缀。

比方说，有这样一个字符串： `madamimadam`，我们将这个字符串的各个字符予以标号：

```
序号： 1  2  3  4  5  6  7  8  9  10 11
字符： m  a  d  a  m  i  m  a  d  a  m
```

现在，火星人定义了一个函数 *mathrm{LCQ}(x, y)*，表示：该字符串中第 *x* 个字符开始的字串，与该字符串中第 *y* 个字符开始的字串，两个字串的公共前缀的长度。

比方说，*mathrm{LCQ}(1, 7) = 5, mathrm{LCQ}(2, 10) = 1, mathrm{LCQ}(4, 7) = 0*。

在研究 *mathrm{LCQ}* 函数的过程中，火星人发现了这样的一个关联：

如果把该字符串的所有后缀排好序，就可以很快地求出 *mathrm{LCQ}* 函数的值；同样，如果求出了 *mathrm{LCQ}* 函数的值，也可以很快地将该字符串的后缀排好序。

尽管火星人聪明地找到了求取 *mathrm{LCQ}* 函数的快速算法，但不甘心认输的地球人又给火星人出了个难题：

在求取 *mathrm{LCQ}* 函数的同时，还可以改变字符串本身。

具体地说，可以更改字符串中某一个字符的值，也可以在字符串中的某一个位置插入一个字符。

地球人想考验一下，在如此复杂的问题中，火星人是否还能够做到很快地求取 *mathrm{LCQ}* 函数的值。

### 输入格式

第一行给出初始的字符串。

第二行是一个非负整数 *M*，表示操作的个数。

接下来的 *M* 行，每行描述一个操作。操作有 *3* 种，如下所示：

1. 询问。语法： `Q x y`，*x,y* 均为正整数。功能：计算 *mathrm{LCQ}(x,y)*。 限制：*1 ≤ x,y ≤* 当前字符串长度。
2. 修改。语法： `R x d`，*x* 是正整数，*d* 是字符。功能：将字符串中第 *x* 个数修改为字符 *d*。限制：*x* 不超过当前字符串长度。
3. 插入：语法： `I x d`，*x* 是非负整数，*d* 是字符。功能：在字符串第 *x* 个字符之后插入字符 *d*，如果 *x=0*，则在字符串开头插入。限制：*x* 不超过当前字符串长度。

### 输出格式

对于输入中每一个询问操作，你都应该输出对应的答案。

一个答案一行。

### 数据范围

所有字符串自始至终都只由小写字母构成。

*1 ≤ M ≤ 150000*,

字符串长度 *L* 自始至终都满足 *L ≤ 100000*,

询问操作的个数不超过 *10000* 个。

### 输入样例：

```
madamimadam
7
Q 1 7
Q 4 8
Q 10 11
R 3 a
Q 1 7
I 10 a
Q 2 11
```

### 输出样例：

```
5
1
0
2
1
```
