## [560. 逃离洞穴](https://www.acwing.com/problem/content/562/)

### 题目

Raven 先生被困了一个洞穴中，洞穴可以表示为一个由 *N* 行和 *M* 列矩阵。

其中行从上到下编号为 *1* 到 *N*，列从左到右编号为 *1* 到 *M*，第 *i* 行和第 *j* 列的方格区域用 *(i,j)* 表示。

Raven 先生目前在 *(S_R,S_C)*，洞穴的出口位于 *(T_R,T_C)*。

有一些方格区域内包含障碍物，Raven 先生无法进入到其中。

有些方格区域包含陷阱，Raven 先生第一次进入带陷阱的区域时，他必须花费相当于陷阱强度的能量点方可进入，如果他的能量点少于所需能量，他就无法进入该区域。

此外，一些方格区域含有药水，Raven 先生第一次进入包含药水的区域时，他能获得相当于药水强度的能量点。

Raven 先生最初拥有 *E* 个能量点。

他可以从一个方格区域内移动到另一个与该区域拥有公共边的方格区域内。

在出口区域处，Raven 先生可以选择不离开洞穴并继续探索洞穴。

如果有可能的话，你可以帮助他计算出他离开洞穴时能够获得的最大能量点是多少吗？

### 输入格式

第一行包含整数 *T*，表示共有 *T* 组测试数据。

每组数据的第一行包括 *N,M,E,S_R,S_C,T_R,T_C* 共计七个整数。

接下来 *N* 行每行包含 *M* 个整数用以描述整个洞穴，其中第 *i* 行第 *j* 列的整数 *V_{ij}* 表示洞穴第 *i* 行第 *j* 列的区域的具体情况。

*V_{ij}*可以是下列整数之一：

*0*：表示空方格。

*-100000*：表示具有障碍物的方格。

*-99999*和 *-1* 之间的整数（包括两者）：表示强度为 *-V_{ij}*的陷阱。

*1* 到 *99999* 之间的整数（包括两者）：代表强度为 *V_{ij}* 的药水。

### 输出格式

每组数据输出一个结果，每个结果占一行。

结果表示为 `Case #x: y`，其中 *x* 为组别编号（从 *1* 开始），*y* 为 Raven 先生到达洞穴出口时可以获得的最大能量点，如果 Raven 先生无法到达出口，则输出 *-1*。

### 数据范围

*1 ≤ T,N,M ≤ 100*,

*0 ≤ E ≤ 10^5*,

*1 ≤ S_R,T_R ≤ N*,

*1 ≤ S_C,T_C ≤ M*,

*(S_R,S_C) ≠ (T_R,T_C)*,

*-10^5 ≤ V_{ij} < 10^5*,

数据保证陷阱数量不超过 *15* 个，起点和出口区域都为空区域。

### 输入样例：

```
2
4 4 100 1 1 4 4
0 0 0 0
0 0 0 0
0 0 0 -100000
0 0 -100000 0
8 8 250 7 1 1 7
-100000 -100000 -100000 -100000 -100000 -100000 0 -100000
-100000 0 -100000 0 -400 0 0 -100000
-100000 100 -300 0 -100000 -300 -100000 -100000
-100000 0 -100000 500 -100000 250 0 -100000
-100000 -200 -100000 -100000 -100000 -100000 -100 -100000
-100000 0 -100000 0 0 50 50 -100000
0 0 -100 0 -100000 50 -100000 -100000
-100000 -100000 -100000 -100000 -100000 -100000 -100000 -100000
```

### 输出样例：

```
Case #1: -1
Case #2: 250
```

### 样例解释

在样本案例＃1中，Raven 先生不可能到达出口。

在样本案例＃2中，洞穴如下图所示

 ![QQ截图20190330153415.png](https://cdn.acwing.com/media/article/image/2019/03/30/19_3f6e5ca452-QQ截图20190330153415.png)

具有正整数 *x* 的单元表示具有强度 *x* 的药水。

具有负整数 *y* 的单元表示具有强度 *-y* 的陷阱。

Raven先生的初始位置已经标出。

在这种情况下，以最大能量点到达出口的最佳方式之一是

- 开始时 *250* 个能量点。
- 去破坏位于 *(7,3)* 位置的陷阱。剩余 *150 *个能量点。
- 收集位于 *(6,6)*，*(6,7)* 和 *(7,6)* 位置的三个药水。剩余 *300* 个能量点。
- 去破坏位于 *(5,7)* 位置的陷阱。剩余 *200* 个能量点。
- 收集位于 *(4,6)* 位置的药水。剩余 *450* 个能量点。
- 去破坏位于 *(5,2)* 位置的陷阱。剩余 *250* 个能量点。
- 收集位于 *(3,2)* 位置的药水。剩余 *350* 个能量点。
- 去破坏位于 *(3,3)* 位置的陷阱。剩余 *50* 个能量点。
- 收集位于 *(4,4)* 位置的药水。剩余 *550* 个能量点。
- 去破坏位于 *(3,6)* 位置的陷阱，然后以 *250* 个能量点离开。
