## [2259. 物流运输](https://www.acwing.com/problem/content/2261/)

### 题目

物流公司要把一批货物从码头 *A* 运到码头 *B*。

由于货物量比较大，需要 *n* 天才能运完。

货物运输过程中一般要转停好几个码头。

物流公司通常会设计一条固定的运输路线，以便对整个运输过程实施严格的管理和跟踪。

由于各种因素的存在，有的时候某个码头会无法装卸货物。

这时候就必须修改运输路线，让货物能够按时到达目的地。

但是修改路线是一件十分麻烦的事情，会带来额外的成本。

因此物流公司希望能够订一个 *n* 天的运输计划，使得总成本尽可能地小。

### 输入格式

第一行是四个整数 *n、m、K* 和 *e*。*n* 表示货物运输所需天数，*m* 表示码头总数，*K* 表示每次修改运输路线所需成本，*e* 表示航线数量。

接下来 *e* 行每行是一条航线描述，包括了三个整数，依次表示航线连接的两个码头编号以及航线长度（*>0*）。

所有码头编号从 *1* 到 *m*，其中码头 *A* 编号为 *1*，码头 *B* 编号为 *m*。

单位长度的运输费用为 *1*。航线是 **双向** 的。

再接下来一行是一个整数 *d*，后面的 *d* 行每行是三个整数 *P、a、b*。表示编号为 *P* 的码头从第 *a* 天到第 *b* 天无法装卸货物（含头尾）。

同一个码头有可能在多个时间段内不可用。但任何时间都存在至少一条从码头 *A* 到码头 *B* 的运输路线。

### 输出格式

包括了一个整数表示最小的总成本。

总成本 *=* *n* 天运输路线长度之和 *+* *K ×* 改变运输路线的次数。

### 数据范围

*1 ≤ n ≤ 100*,

*1 ≤ m ≤ 20*,

*1 < P < m*,

*1 ≤ a ≤ b ≤ n*

### 输入样例：

```
5 5 10 8
1 2 1
1 3 3
1 4 2
2 3 2
2 4 4
3 4 1
3 5 2
4 5 2
4
2 2 3
3 1 1
3 3 3
4 4 5
```

### 输出样例：

```
32
```

### 样例解释

 ![QQ截图20200805104909.png](https://cdn.acwing.com/media/article/image/2020/08/05/19_89b87190d6-QQ截图20200805104909.png)

上图依次表示第一至五天的情况。红色表示不可用的码头。

前三天走 *1-4-5*，后两天走 *1-3-5*，这样总成本为 *(2+2) × 3+(3+2) × 2+10=32*。
