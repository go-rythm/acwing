## [3270. 数据中心](https://www.acwing.com/problem/content/3273/)

### 题目

在一个集中式网络中，存在一个根节点，需要长时间接收其余所有节点传输给它的反馈数据。

存在一个 *n* 节点的网络图，编号从 *1* 到 *n*。

该网络的传输是全双工的，所以是无向图。

如果两节点 *v_i, u_i* 相连，表明 *v_i, u_i* 之间可以互相收发数据，边权是传输数据所需时间 *t_i*。

**现在每个节点需要选择一条路径将数据发送到 *root* 号节点**。

希望求出一个最优的树结构传输图，使得完成这个任务所需要的时间最少。

*root* 节点只能接收数据，其余任何一个节点可以将数据传输给另外的一个节点，但是不能将数据传输给多个节点。

所有节点可以接收多个不同节点的数据。

 ![QQ截图20210219161934.png](https://cdn.acwing.com/media/article/image/2021/02/19/19_36500be372-QQ截图20210219161934.png)

一个树结构传输图的传输时间为 *T_{max}*，其中 *T_{max} = max(T_h)*，*h* 为接收点在树中的深度，*T_h = max(t_{h ,j})*，*t_{h,j}* 表示 *j* 条不同的边，这 *j* 条边接收点的深度都为 *h*。

### 输入格式

第 *1* 行包含一个正整数 *n*。

第 *2* 行包含一个正整数 *m*。

第 *3* 行包含一个正整数 *root*。

第 *4* 行至第 *3+m* 行包含 *3* 个正整数 *v_i, u_i,t_i*。

### 输出格式

输出仅有一行，包含一个正整数 *ans*，表示最优的树结构流水线所耗时 *T_{max}*。

### 数据范围

子任务 *1*（*20* 分），*n ≤ 10^2,m ≤ 4500*。

子任务 *2*（*30* 分），*n ≤ 10^3,m ≤ 3 × 10^4*。

子任务 *3*（*20* 分），*n ≤ 10^4,m ≤ t × 10^4*。

子任务 *4*（*30* 分），*n ≤ 5 × 10^4,m ≤ 10^5*。

所有子任务：*v_i,u_i,t_i*，保证 *v_i ≤ 5 × 10^4,u_i ≤ 5 × 10^4,t_i ≤ 10^6,u_i ≠ v_i*。

数据保证有解且没有重边。

### 输入样例：

```
4
5
1
1 2 3
1 3 4
1 4 5
2 3 8
3 4 2
```

### 输出样例：

```
4
```

### 样例说明

 ![QQ截图20210219164011.png](https://cdn.acwing.com/media/article/image/2021/02/19/19_17b6d6bd72-QQ截图20210219164011.png)
