## [547. 滑翔伞](https://www.acwing.com/problem/content/549/)

### 题目

 ![untitled.png](https://cdn.acwing.com/media/article/image/2019/03/28/19_9913fec450-untitled.png)

为了打败邪恶的魔王，我们的英雄 Edge 必须通过神社的挑战。

神殿在 *xy* 平面内是二维的，并且沿着平面的 *x* 轴竖立有 *N* 个塔（具有不同的高度）。

每个塔可以由 *2D* 平面中的垂直线段表示。

对于塔 *i*，塔的底部位于 *(p_i，0)*，塔的顶部位于 *(p_i，h_i)*。

还有 *K* 个气球漂浮在平面上。

每个气球可以由 *2D* 平面中的单个点表示，气球 *i* 位于 *(x_i，y_i)*。

Edge 必须在此挑战中收集尽可能多的气球。

幸运的是，Edge 有一个可靠的滑翔伞，他可以选择攀爬任何一座塔，并从塔上的任何位置向下滑向 *x* 轴的正方向或负方向。

当他滑行时，他沿着直线路径下降，相对于塔成 *45* 度角。

Edge 可以在从塔上滑下来的过程中收集接触到的气球。

他可以尝试无数次爬上塔楼并向下滑翔摘取气球这一过程。

如果他在下降期间接触到一座塔楼，那么他就被认为是在落在了这座塔楼之上。

你可以假设 Edge 是 *xy* 平面中的单个点。

通过使用一对由古老技术制成的护目镜，Edge 能够计算出每个塔和气球的高度和位置。

有了这些信息，你能否帮助 Edge 推断出他可以在这个神殿中收集的最大气球数量？

### 输入格式

第一行包含整数 *T*，表示共有 *T* 组测试数据。

每组测试数据包含五行，第一行包含两个整数 *N* 和 *K*。

接下来的四行每行包含六个整数，四行分别包含用于生成塔的位置和高度以及气球的 *x* 和 *y* 坐标的参数。格式如下：

*p_1 p_2 A_1 B_1 C_1 M_1*

*h_1 h_2 A_2 B_2 C_2 M_2*

*x_1 x_2 A_3 B_3 C_3 M_3*

*y_1 y_2 A_4 B_4 C_4 M_4*

我们用下列式子生成 *p_i,h_i,x_i,y_i*:

*p_i = (A_1 × p_{i - 1} + B_1 × p_{i - 2} + C_1) bmod M_1 + 1, (3 ≤ i ≤ N)*

*h_i = (A_2 × h_{i - 1} + B_2 × h_{i - 2} + C_2) bmod M_2 + 1, (3 ≤ i ≤ N)*

*x_i = (A_3 × x_{i - 1} + B_3 × x_{i - 2} + C_3) bmod M_3 + 1, (3 ≤ i ≤ K)*

*y_i = (A_4 × y_{i - 1} + B_4 × y_{i - 2} + C_4) bmod M_4 + 1, (3 ≤ i ≤ K)*

保证没有两座塔共用同一个位置。

然而，塔可以与气球重叠,在这种情况下，我们假设可以收集气球。

请注意，两个或更多气球可能在同一点上;在这种情况下，Edge 可以在通过该点时一次收集所有点上气球。

### 输出格式

每组数据输出一个结果，每个结果占一行。

结果表示为 `Case #x: y`，其中 *x* 为组别编号（从 *1* 开始），*y* 为 Edge 可以收集的最大气球数。

### 数据范围

*1 ≤ T ≤ 100*,

*0 ≤ A_i,B_i,C_i ≤ 10^9*,

*1 ≤ M_i ≤ 10^9*,

*1 ≤ p_1,p_2,h_1,h_2,x_1,x_2,y_1,y_2 ≤ 10^9*,

*p_i ≠ p_j,(i ≠ j)*,

*2 ≤ N,K ≤ 10^5*

### 输入样例：

```
2
3 2
1 4 1 1 0 11
4 1 1 1 8 11
2 5 0 0 0 11
4 1 0 0 0 11
5 5
2 4 1 0 1 13
4 4 0 1 12 13
1 4 1 1 0 13
3 5 1 1 7 13
```

### 输出样例：

```
Case #1: 1
Case #2: 4
```

### 样例解释

样例＃1中，生成的各参数数组是：

*p = [1,4,6]*。

*h = [4,1,3]*。

*x = [2,5]*。

*y = [4,1]*。

样例＃2中，生成的各参数数组是：

*p = [2,4,6,8,10]*。

*h = [4,4,4,4,4]*。

*x = [1,4,6,11,5]*。

*y = [3,5,3,3,1]*。
