## [579. 夏洛克和矩阵游戏](https://www.acwing.com/problem/content/581/)

### 题目

今天，夏洛克和华生参加了一个关于矩阵的讲座。

夏洛克给华生出了一个关于矩阵的问题。

夏洛克给了华生两个一维矩阵 *A* 和 *B*；并要求华生形成一个 *N* 行和 *N* 列的矩阵，其中第 *i* 行中的第 *j* 个元素是 *A* 的第 *i* 个元素和 *B* 的第 *j* 个元素的乘积。

用 *(x,y)* 表示矩阵中位于第 *x* 行（从 *0* 开始，从顶行开始）和第 *y* 列（从左列开始从 *0* 开始编号）的单元格。

一个子矩阵的左下角和右上角的单元格分别用 *(a,b)* 和 *(c,d)* 表示，其中 *a ≥ c* 和 *d ≥ b*，子矩阵中包含的所有单元格 *(i,j)* 均满足 *c ≤ i ≤ a* 且 *b ≤ j ≤ d*。

子矩阵的总和被定义为子矩阵的所有单元格内元素的总和。

为了考验华生，夏洛克给了他一个整数 *K*，并要求他输出矩阵的所有子矩阵中的第 *K* 个最大和，其中 *K* 从 *1* 开始计算最大值。（有可能一个总和对应多个 *K* 值，这代表可能存在多个具有相同总和的子矩阵）

你能帮助华生吗？

### 输入格式

第一行包含整数 *T*，表示共有 *T* 组测试数据。

每组数据第一行包含九个整数 *N,K,A_1,B_1,C,D,E_1,E_2,F* 组成，*N* 是一维矩阵 *A* 和 *B* 的长度; *K* 如题目所述，*A_1* 和 *B_1* 分别是 *A* 和 *B* 中的第一个元素; 其他五个值是你应该用于生成数组元素的参数，如下所示：

首先定义 *x_1 = A_1,y_1 = B_1,r_1 = 0,s_1 = 0*，然后，使用下列等式生成 *i = 2* 到 *N* 的 *x_i* 和 *y_i*：

*x_i = ( C × x_{i-1} + D × y_{i-1} + E_1 ) bmod F*

*y_i = ( D × x_{i-1} + C × y_{i-1} + E_2 ) bmod F*

此外，使用下列等式生成 *i = 2* 到 *N* 的 *r_i* 和 *s_i*：

*r_i = ( C × r_{i-1} + D × s_{i-1} + E_1 ) bmod 2*

*s_i = ( D × r_{i-1} + C × s_{i-1} + E_2 ) bmod 2*

对于所有 *i = 2* 到 *N*，我们定义 *A_i = (-1)^{r_i} × x_i* 以及 *B_i = (-1)^{s_i} × y_i*。

### 输出格式

每组数据输出一个结果，每个结果占一行。

结果表示为 `Case #x: y`，其中 *x* 为组别编号（从 *1* 开始），*y* 是所有子矩阵中第 *K* 个最大和。

### 数据范围

*1 ≤ T ≤ 20*,

*1 ≤ K ≤ min(10^5,可能的子矩阵总数)*,

*0 ≤ A_1,B_1,C,D,E_1,E_2 ≤ 10^3*,

*1 ≤ F ≤ 10^3*,

*1 ≤ N ≤ 200*

### 输入样例：

```
4
2 3 1 1 1 1 1 1 5
1 1 2 2 2 2 2 2 5
2 3 1 2 2 1 1 1 5
9 8 7 6 5 4 3 2 1
```

### 输出样例：

```
Case #1: 6
Case #2: 4
Case #3: 1
Case #4: 42
```

### 样例解释

在样例#1中，矩阵 *A* 和 *B* 分别是 *[1，-3]* 和 *[1，-3]*。

由此可得形成的矩阵是

```
[1,-3]
[-3,9]
```

所有可能的子矩阵按递减顺序排列为 *[9,6,6,4,1,-2,-2,-3,-3]*。

当 *K = 3* 时，答案是 *6*。
