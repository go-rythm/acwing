## [3323. 画家的对决](https://www.acwing.com/problem/content/3326/)

### 题目

一个新的艺术博物馆即将开放！

博物馆只有一层，呈大等边三角形形状。

该等边三角形博物馆由许多较小的相同的等边三角形房间组成，博物馆的边长是任一房间边长的 *S* 倍。

每个房间都有很多门，将其与所有和它共用一条边（而不仅仅是共用一个点）的房间连通。

每个房间都标有两个数字：房间所在行（从上到下，从 *1* 计数），以及在该行的位置（从左到右，从 *1* 计数）。

下图是当 *S=3* 时，房间如何连通以及标记的示例：

 ![example.png](https://cdn.acwing.com/media/article/image/2021/03/30/19_b99ad43a91-example.png)

Alma 和 Berthe 是正在粉刷博物馆房间的艺术家。

开始时，Alma 位于房间 *R_A,P_A*，Berthe 位于房间 *R_B,P_B*。

两人都已经将自己开始时待的房间粉刷好了。

有 *C* 个房间现在正在装修，无法进入，也无法被粉刷。

两人正在进行一场友好的比赛，比赛按照回合制来进行。

Alma 首先开始。

在轮到一名画家的回合时，如果其当前所在的房间与至少一个未处于装修状态且未被粉刷的房间相连通，那么他就必须选择其中一个房间，进入并粉刷该房间。

否则，该画家就只能原地停留，跳过接下来的所有回合。

当两名画家都无法进行任何动作时，游戏就结束了。

游戏的分数为 Alma 粉刷的房间数量减去 Berthe 粉刷的房间数量。

双方都采取最佳决策，Alma 会试图最大化得分，而 Berthe 会试图最小化得分。

鉴于此，请你确定无论 Berthe 如何举动，Alma 都可以保证获得的最大得分。

### 输入格式

第一行包含整数 *T*，表示共有 *T* 组测试数据。

每组数据第一行包含 *6* 个整数，*S, R_A, P_A, R_B, P_B, C*。

接下来 *C* 行，每行包含两个整数 *R_i,P_i* 表示一个正在装修的房间的位置。

### 输出格式

每组数据输出一个结果，每个结果占一行。

结果表示为 `Case #x: y`，其中 *x* 为组别编号（从 *1* 开始），*y* 是 Alma 可以保证获得的最大得分。

### 数据范围

*50%* 的数据满足：*T = 48,S = 2*。

另外 *50%* 的数据满足：*1 ≤ T ≤ 100,2 ≤ S ≤ 6*。

*100%* 的数据满足：

*0 ≤ C ≤ S^2-2*，

*1 ≤ R_A ≤ S*，*1 ≤ P_A ≤ 2 × R_A - 1*，

*1 ≤ R_B ≤ S*，*1 ≤ P_B ≤ 2 × R_B - 1*，

*(R_A,P_A) ≠ (R_B,P_B)*，

对于所有 *i* 满足，*1 ≤ R_i ≤ S*，*1 ≤ P_i ≤ 2 × R_i - 1*，*(R_i,P_i) ≠ (R_A,P_A)*，*(R_i,P_i) ≠ (R_B,P_B)*，

对于所有 *i < C* 满足，要么 *R_i < R_{i+1}*，要么 *R_i = R_{i+1}* 并且 *P_i < P_{i+1}*。

### 输入样例：

```
2
2 1 1 2 1 0
2 2 2 1 1 2
2 1
2 3
```

### 输出样例：

```
Case #1: 2
Case #2: 0
```

### 样例解释

对于测试数据 *1*，各个回合一定会进行如下：

1. Alma 移动至房间 *(2,2)*。
2. Berthe 无法移动。
3. Alma 移动至房间 *(2,3)*。
4. Berthe 无法移动。
5. Alma 无法移动，游戏结束。

Alma 粉刷了 *3* 个房间，Berthe 粉刷了 *1* 个房间，所以最高得分为 *3-1=2*。

对于测试数据 *2*，两人都无法移动，因此得分为 *0*。

如下额外测试样例，不会出现在前 *50%* 的数据中，但可能出现在后 *50%* 的数据中。

```
2
3 3 4 2 1 2
2 3
3 1
3 3 2 2 3 2
2 1
3 1
```

正确输出应当是：

```
Case #1: 0
Case #2: -1
```

对于测试数据 *1*，Alma 可以移动至 *(3,5)* 或 *(3,3)*，无法移动至 *(2,3)*，这里正在装修。

- 如果她移动至 *(3,5)*，她就无法再移动了，Berthe 将继续为两个房间进行粉刷，得分为 *2-3=-1*。
- 如果她移动至 *(3,3)*，那么 Berthe 可以做出如下行动：
    - 移动至 *(3,2)*，这将使得两人均无法再进行移动，因此得分为 *2-2=0*。
    - 移动至 *(2,2)*，然后接下来的游戏一定会按照如下进行：Alma 移动至 *(3,2)*，Berthe 移动至 *(1,1)*，得分为 *3-3=0*。

所以 Alma 清楚移动至 *(3,3)* 可以确保无论 Berthe 如何抉择，都能保证得分为 *0*，这比移动至 *(3,5)* 使得得分为 *-1* 要好。

因此 Alma 选择移动至 *(3,3)*。

注意：

- 我们无法确定剩余比赛的具体发展，但是我们可以确定 Alma 保证可以获得的最高得分。
- 可能存在一个或多个未处于装修状态的房间无法得到粉刷。

对于测试数据 *2*，Alma 必须移动至 *(3,3)*，接下来 Berthe 最好移动至 *(3,4)* 而不是 *(2,2)*。
