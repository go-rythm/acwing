## [2130. 分形](https://www.acwing.com/problem/content/2132/)

### 题目

分形是分数维的，介于 *2* 维与 *3* 维之间。

完整的分形图往往具有有界的面积和无限的周长。

为了探寻分形的奥秘，King 执着地进行着与众不同的研究。

首先他研究简单分形：平面上有一个半径为 *R_0(R_0=10^5)* 的圆，圆心处于坐标原点，它与若干个半径为 *R_1* 的圆外切，每个半径为 *R_1* 的圆与若干个半径为 *R_2* 的圆外切，……，每个半径为 *R_i* 的圆与若干个半径为 *R_{i+1}* 的圆外切。

任意两圆不相交、不重叠、不内含、不内切。

半径为 *R_i* 的圆只可能与半径为 *R_{i-1}* 或 *R_{i+1}* 的圆外切，*i>0* 时恰与 *1* 个半径为 *R_{i-1}* 的圆外切。

作为基础，他先研究有限层的简单分形，即只由半径为 *R_0 ~ R_n* 的圆构成的 *n+1* 层分形。

图 *1*是一个 *5* 层简单分型。

由于只有有限层，所以此图的边界为有限长。

 ![QQ截图20200716093416.png](https://cdn.acwing.com/media/article/image/2020/07/16/19_7f5e5178c7-QQ截图20200716093416.png)

King 在边界上找出了与分形图的性质有关的若干个点对 *(P_i,Q_i)*，他想知道沿着圆的边界从 *P_i* 到 *Q_i*，最短的光滑路径的长度是多少（如图 *1* 中的加粗曲线）。

光滑路径是指：路径在两圆公切点拐弯时切线方向保持不变。

图 *2* 中左边两段（加粗）路径是光滑的，而右边的（加粗）路径不光滑。

 ![QQ截图20200716093659.png](https://cdn.acwing.com/media/article/image/2020/07/16/19_de3b2bf8c7-QQ截图20200716093659.png)

### 输入格式

第一行为 *3* 个整数 *n,m,t*，其中 *m* 表示圆的个数，并且圆的编号为 *1 ~ m*。*t* 为特殊点对数。

第二行为 *n* 个正整数 *R_1 ~ R_n*。

接下来的 *m* 行表示各个圆，每行有 *4* 个数 *X_i,Y_i,S_i,F_i*，*(X_i,Y_i)* 是圆 *i* 的圆心位置，圆 *i* 的半径是 *R_{S_i}*，与圆 *i* 相切的尺寸更大的圆的编号是 *F_i*，*X_i* 和 *Y_i* 可能是实数，并且 *X_1=Y_1=S_1=F_1=0*。

再接下来的 *t* 行表示各个特殊点对，每行有 *4* 个数 *P_{iW},P_{iA},Q_{iW},Q_{iA}*，用于描述一个特殊点对 *(P_i,Q_i)* 的位置：*P_{iW}* 表示点 *P_i* 处于 *P_{iW}* 这个圆上，并且以此圆圆心为原点的幅角为 *P_{iA}*。*Q_{iW}* 表示点 *Q_i* 处于 *Q_{iW}* 这个圆上，并且以此圆圆心为原点的幅角为 *Q_{iA}*。输入数据保证 *P_{iW}≠Q_{iW}*，任意特殊点不会同时处于两个圆上（即切点处无特殊点）并且一个圆最多与 *10* 个圆相切。

### 输出格式

共 *t* 行，其中第 *i* 行是一个整数 *L_i*，表示从点 *P_i* 到点 *Q_i* 的最短光滑路径的长度*/π* 后精确到整数的结果。

### 数据范围

*1 ≤ n*,

*n + 1 ≤ m ≤ 3000*,

*1 ≤ t ≤ 10^5*,

当 *i ≥ 1* 时，*1 < R_i < R_{i-1}-1*,

*0 ≤ P_{iA},Q_{iA} < 2π*

### 输入样例：

```
1 3 3
50000
0 0 0 0
150000 0 1 1
0 150000 1 1
3 5.497787 2 2.356194
3 1.570796 2 0.0
3 0.0 2 1.570796
```

### 输出样例：

```
175000
150000
200000
```
