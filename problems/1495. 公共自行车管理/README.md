## [1495. 公共自行车管理](https://www.acwing.com/problem/content/1497/)

### 题目

杭州市设有公共自行车服务，为来自世界各地的游客提供了极大的便利。

游客可以在任何车站租用一辆自行车，然后可在城市中的任意其他车站将其归还。

公共自行车管理中心（*PBMC*）不断监测所有站点的实时容量。

如果一个车站自行车存量刚满一半，则称其处于理想状态。

如果一个车站已满或空了，*PBMC* 会收集或派送自行车以将该车站的状况调整到最佳状态。

而且，途中的所有车站也会调整至最佳。

当出现需要调整的车站时，*PBMC* 将始终选择到达该站点的最短路径，前去该站点进行车辆调整。

如果最短路径多于一条，则将选择需要从 *PBMC* 发送的自行车数量最少的那条路径。

 ![213.jpg](https://cdn.acwing.com/media/article/image/2020/03/21/19_a2b21f8a6b-213.jpg)

上图给出了一个示例，车站以及 *PBMC* 由点表示，道路由边表示。

边上的数字是从一个站点到达另一个站点所花费的时间。

点内的数字是车站目前的自行车存量。

假设每个站点最多存 *10* 辆车。

我们现在要给车站 *S_3* 送自行车，共有两条最短路径可选：

1. *PBMC to S_1 to S_3*，这种路线需要从 *PBMC* 发送 *4* 辆自行车，因为我们可以从 *S_1* 收集 *1* 辆车，并需要给 *S_3* 派送 *5* 辆车，这样两个站点就都调整到最佳状态了。
2. *PBMC to S_2 to S_3*，这种路线与上一条路线距离相同，但是只需要从 *PBMC* 发送 *3* 辆自行车，因此 **这条路径应该被选择**。

### 输入格式

第一行包含四个整数，*C_{max}*，表示每个车站的最大存车量；*N*，表示车站总数；*S_p*，表示需要处理站点的编号（所有站点编号 *1 ~ N*，*PBMC* 编号为 *0*)；*M*，表示道路数量。

第二行包含 *N* 个非负整数 *C_i*，其中第 *i* 个数表示编号为 *i* 的站点的现存车辆。

接下来 *M* 行，每行包含三个整数 *S_i,S_j,T_{ij}*，表示站点 *S_i* 与站点 *S_j* 之间存在一条 **双向** 道路，行走时长为 *T_{ij}*。

### 输出格式

输出共一行，首先输出需要从 *PBMC* 发送的自行车数量，然后输出发送路径，格式为 `0->2->3`，最后输出当 *S_p* 站点调整至最佳后，需要带回至 *PBMC* 的自行车数量。

三个输出部分之间用空格隔开。

注意，如果按照上述规则，仍然无法选出最优选择，那么选择需要带回车辆最少的路线。

### 数据范围

*1 ≤ C_max ≤ 100*,

*1 ≤ N ≤ 500*,

*1 ≤ S_p ≤ N*,

*1 ≤ M ≤ 2000*,

*1 ≤ T_{ij} ≤ 500*

### 输入样例：

```
10 3 3 5
6 7 0
0 1 1
0 2 1
0 3 3
1 3 1
2 3 1
```

### 输出样例：

```
3 0->2->3 0
```
