## [2906. 朋友圈](https://www.acwing.com/problem/content/2909/)

### 题目

在很久很久以前，曾经有两个国家和睦相处，无忧无虑的生活着。

一年一度的评比大会开始了，作为和平的两国，一个朋友圈数量最多的永远都是最值得他人的尊敬，所以现在就是需要你求朋友圈的最大数目。

两个国家看成是 *A、B* 两国，现在是两个国家的描述：

1. *A* 国：每个人都有一个友善值，当两个 *A* 国人的友善值 *a、b*，如果 *a xor b bmod 2 = 1*，那么这两个人都是朋友，否则不是；
2. *B* 国：每个人都有一个友善值，当两个 *B* 国人的友善值 *a、b*，如果 *a xor b bmod 2 = 0* 或者 *(a or b)* 化成二进制有奇数个 *1*，那么两个人是朋友，否则不是朋友；
3. *A、B* 两国之间的人也有可能是朋友，数据中将会给出 *A、B* 之间“朋友”的情况。
4. 在 *A、B* 两国，朋友圈的定义：一个朋友圈集合 *S*，满足 *S in A cup B*，对于所有的 *i,j in S* ，*i* 和 *j* 是朋友。

由于落后的古代没有电脑，这个也就成了每年最大的难题，而你能帮他们求出最大朋友圈的人数吗？

### 输入格式

第一行输入三个整数 *A,B,M*，表示 *A* 国人数、*B* 国人数、*A、B* 两国之间是朋友的对数；

第二行 *A* 个数 *a_i*，表示 *A* 国第 *i* 个人的友善值；

第三行 *B* 个数 *b_i*，表示 *B* 国第 *j* 个人的友善值；

第 *4 ~ 3+M* 行，每行两个整数 *(i,j)*，表示第 *i* 个 *A* 国人和第 *j* 个 *B* 国人是朋友。

*A* 国人编号 *1 ~ A*，*B* 国人编号 *1 ~ B*。

### 输出格式

输出 *t* 行，每行输出一个整数，表示最大朋友圈的数目。

### 数据范围

存在两类数据：

- 第一类满足 *A ≤ 200,B ≤ 200*。
- 第二类满足 *A ≤ 10,B ≤ 3000*。

*1 ≤ M ≤ 20001*,

*1 ≤ a_i,b_i ≤ 2 × 10^9*

### 输入样例：

```
2 4 7
1 2
2 6 5 4
1 1
1 2
1 3
2 1
2 2
2 3
2 4
```

### 输出样例：

```
5
```

### 样例解释

最大朋友圈包含 *A* 国第 *1、2* 人和 *B* 国第 *1、2、3* 人。
