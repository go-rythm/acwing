## [1675. 哞里奥卡丁车](https://www.acwing.com/problem/content/1677/)

### 题目

贝茜和农夫约翰都对山羊卡丁车十分感兴趣。

这个卡丁车比赛与其他人喜欢的卡丁车比赛非常相似，区别在于卡丁车由山羊拉动，赛道由附近的农田组成。

农田由 *N* 个草地和 *M* 条道路组成，每条道路连接一对草地。

贝茜想要在附近的农场上做出一个赛道。

农场是两个或多个草地的集合，其中的每个草地都可以沿着一条唯一的路径到达该农场中的任意一个其他草地。

附近的农田可能包含多个农场。

假设共有 *K* 个农场，贝茜希望通过添加长度为 *X* 的 *K* 条道路来连接所有 *K* 个农场，从而形成一个山羊卡丁车循环赛道。

每个农场应该恰好访问一次，并且每个农场内必须至少有一条道路作为赛道供选手经过。

为了使赛车手们对赛道更感兴趣，赛道的总长度应该至少为 *Y*。

贝茜想知道所有满足上述条件且能让赛车手感兴趣的赛道的长度之和是多少。

如果一个赛道中有两个草地是相邻的（在农场之间增加了道路之后），而在另一个赛道中，这两个草地不相邻，则两个赛道被认为是不同赛道。

注意，判断不同赛道时，只考虑选取道路的差异，不考虑选手们沿着赛道行驶的方向差异。

### 输入格式

第一行包含四个整数 *N,M,X,Y*。

接下来 *M* 行用来描绘道路，每行包含三个整数 *A_i,B_i,D_i*，表示草地 *A_i* 和草地 *B_i* 之间存在一条长度为 *D_i* 的道路。

每个草地都至少被一条道路连接，且不存在自环。

### 输出格式

输出一个整数，表示所有满足条件的有趣赛道的长度之和对 *10^9+7* 取模后的结果。

### 数据范围

*1 ≤ N ≤ 1500*,

*1 ≤ M ≤ N-1*,

*0 ≤ X,Y ≤ 2500*,

*1 ≤ A_i,B_i ≤ N*,

*0 ≤ D_i ≤ 2500*

### 输入样例：

```
5 3 1 12
1 2 3
2 3 4
4 5 6
```

### 输出样例：

```
54
```

### 样例解释

该样例共有 *6* 个满足条件的赛道：

```
1 --> 2 --> 4 --> 5 --> 1 (长度 11)

1 --> 2 --> 5 --> 4 --> 1 (长度 11)

2 --> 3 --> 4 --> 5 --> 2 (长度 12)

2 --> 3 --> 5 --> 4 --> 2 (长度 12)

1 --> 2 --> 3 --> 4 --> 5 --> 1 (长度 15)

1 --> 2 --> 3 --> 5 --> 4 --> 1 (长度 15)
```

其中长度不少于 *12* 的有趣赛道的长度之和为 *12+12+15+15=54*。
