## [2276. 无序运动](https://www.acwing.com/problem/content/2278/)

### 题目

*D* 博士对物理有着深入的研究，经典物理、天体物理、量子物理都有着以他的名字命名的定理。

最近 *D* 博士着迷于研究粒子运动的无规则性。

对圣经深信不疑的他相信，上帝创造的任何事物必然是有序的、有理可循的，而不是无规则的、混沌的。

经过长时间的研究，*D* 博士找到了很多出现相当频繁的轨迹片断，他把这些轨迹片断储存在一个很大的数据库内。

他需要你帮助他写一个程序，对于一个给出的粒子运动轨迹，统计数据库中每个轨迹片断的出现的次数。

为清楚起见，我们定义一个粒子的轨迹为二维平面上的一个点列 *(P_1, P_2, … P_N)*。

点列 *P* 的一个子列 *[i, j]* 定义为 *P* 中一段连续的子序列 *(P_i, P_{i+1}, … P_j)*。

点列 *P* 的一个子列 *[u, v]* 被称为点列 *Q = (Q_1, Q_2 … Q_{v-u+1})* 在 *P* 中的一次出现，当且仅当 *Q* 经过有限次的平移、旋转、翻转、放缩之后得到 *Q’* 满足 *Q’k = P_{u+k-1}(k = 1 … u – v + 1)*。

 ![QQ截图20200806151208.png](https://cdn.acwing.com/media/article/image/2020/08/06/19_2903801cd7-QQ截图20200806151208.png)

### 输入格式

第一行两个整数 *N、M*，分别描述待处理的粒子运动轨迹的点列大小与数据库内的轨迹片断个数。

接下来 *M* 行依次给出每个轨迹片断。每行先是一个正整数 *K*，表示该轨迹片断点列的长度。然后 *2K* 个整数，依次描述点列中的 *K* 个点的横坐标与纵坐标。

接下来一行 *2N* 个整数，依次描述待处理的粒子运动轨迹的点列中 *N* 个点的横坐标与纵坐标。

注：输入中的每条轨迹中任意相邻两点不会相同。

### 输出格式

包含 *M* 行，依次给出每个片段在待处理运动轨迹中的出现次数。

### 数据范围

*1 ≤ N ≤ 100000*,

*1 ≤ M ≤ 50000*,

*1 ≤ K ≤ 100*,

片段总长度 *≤ 1600100*，

输入中给出所有点坐标绝对值均不大于 *10000*。

### 输入样例：

```
3 2
2 17 0 10 1
3 0 0 1 0 1 -1
0 0 1 0 1 1
```

### 输出样例：

```
2
1
```
