## [3314. 金色的石头](https://www.acwing.com/problem/content/3317/)

### 题目

Leopold 的朋友 Kate 喜欢收集石头，所以他想送给她一块金色的石头作为礼物。

共有 *S* 种不同的石头，编号 *1 ~ S*，其中 *1* 号石头是金色的石头。

一些种类的石头会在城市的各个地方轻松找到。

城市包含 *N* 个路口（编号 *1 ~ N*）和 *M* 条双向街道。

每条双向街道连接两个不同的路口。

每个路口可能包含 *0* 种或多种石头，如果一种石头在某个路口可以找到，则认为其在该路口的数量无限多。

不幸的是，金色的石头不存在于任何路口。

幸运的是，Leopold 是个有点东西的魔术师，他知道如何将一组石头进行融合，合成另一种石头。

例如，他有一个秘方，可以利用一块银色的石头和两块大理石合成一块金色的石头。

他获取石头的方式，既可以是去路口找（如果能找到的话），也可以用其它的一些秘方合成。

具体来说，他共有 *R* 种秘方，秘方的形式为 *(a_1,a_2,…,a_k) to b*，其中 *k ≥ 1*。

如果他在某个路口收集齐了 *a_1,a_2,…,a_k* 的 *k* 种石头，他就可以应用秘方将这些石头变为一块 *b* 种类的石头。

相对于耗费体力，Leopold 更愿意开动脑筋。

因此，他不想在城市之中不必要的搬运各种石头。

带着一块石头穿过一条街道将耗费他 *1* 单位的能量。

他一次最多只能携带一块石头。

他可以将携带的石头在任意一个路口扔下，也可以以后随时再将其捡起。

请问他要制作出一块金色的石头最需要耗费的最低能量是多少。

如果答案大于或等于 *10^{12}*，则直接输出 *-1*。

### 输入格式

第一行包含整数 *T*，表示共有 *T* 组测试数据。

每组数据第一行包含四个整数 *N,M,S,R*，分别表示路口数量，街道数量，石头种类数量，秘方数量。

接下来 *M* 行，每行包含两个不同的整数 *U_i* 和 *V_i*，表示存在一条街道连接路口 *U_i* 和 *V_i*。

再接下来 *N* 行，用来描述每个路口能找到的石头种类，其中的第 *i* 行，首先包含一个整数 *C_i*，表示第 *i* 个路口可以找到 *C_i* 种石头，接下来包含 *C_i* 个不同的整数（取值范围为 *[2,S]*）表示每种石头的种类，金色石头的种类永远是 *1*，且绝对不可能在路口直接被找到。

最后 *R* 行，用来描述所有魔法秘方。其中的第 *i* 行，首先包含一个整数 *K_i*，表示合成所需石头数量，接下来包含 *K_i* 个 **不一定不同** 的整数（取值范围为 *[2,S]*）表示所需的每块石头的种类，最后包含一个整数（取值范围为 *[1,S]*）表示合成的石头种类。例如， `3 6 5 6 3` 表示用两块 *6* 号石头和一块 *5* 号石头可以合成一块 *3* 号石头。

保证金色石头一定可以被合成。

### 输出格式

每组数据输出一个结果，每个结果占一行。

结果表示为 `Case #x: y`，其中 *x* 为组别编号（从 *1* 开始），*y* 表示制作出一块金色的石头最需要耗费的最低能量。如果答案大于或等于 *10^{12}*，则直接输出 *-1*。

### 数据范围

*1 ≤ T ≤ 100*,

*1 ≤ U_i,V_i ≤ N*,

*U_i ≠ V_i*，

*0 ≤ C_i < S*,

*1 ≤ K_i ≤ 3*,

*2 ≤ N ≤ 300*,

*1 ≤ M ≤ 500*,

*2 ≤ S ≤ 300*,

*1 ≤ R ≤ 300*,

保证没有重边，

保证图是连通的，

保证金色石头一定能被合成。

### 输入样例：

```
3
4 3 4 1
1 2
1 3
1 4
0
1 2
1 3
1 4
3 2 3 4 1
4 3 4 1
1 2
1 3
1 4
0
2 2 3
1 3
1 4
3 2 3 4 1
2 1 4 2
1 2
2 2 3
1 4
3 2 3 4 1
2 2 3 4
```

### 输出样例：

```
Case #1: 3
Case #2: 2
Case #3: 0
```

### 样例解释

对于测试数据 *1*，可以前往 *2,3,4* 号路口分别收集到石头 *2,3,4*，然后将石头送往路口 *1*，在路口 *1* 使用三种石头各一块合成金色石头。

对于测试数据 *2*，与前一组数据相比，唯一区别在于 *2* 号路口可以收集到石头 *3* 了，此时最佳方式为将石头 *4* 搬运到路口 *2*，然后在路口 *2* 使用三种石头各一块合成金色石头。

对于测试数据 *3*，可以在路口 *1*，先用石头 *2* 和 *3* 合成石头 *4*，然后用石头 *2,3,4* 合成金色石头。
