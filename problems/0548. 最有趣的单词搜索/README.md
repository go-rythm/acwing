## [548. 最有趣的单词搜索](https://www.acwing.com/problem/content/550/)

### 题目

Siv 的生日就在下周，Cel 正在为她准备一份生日礼物。

因为 Siv 喜欢拼图，所以 Cel 打算创造一个单词搜索拼图作为礼物。

在单词搜索拼图中，给定解谜者一个 *R* 行和 *C* 列的矩形网格，每个格子内包含一个字母，解谜者必须找到隐藏在网格内的所有有效单词。

每个隐藏的单词可以在网格中水平或垂直（但不是对角线）出现，正向或反向均可。

隐藏的单词可能会重叠。

Cel 有一个字典，字典中有 *W* 个不同的单词;所有隐藏在拼图网格中的单词都必须出自该字典。（当然，并不是网格中每个连续的水平或垂直部分都必然包含一个隐藏的单词。）

这些单词不一定是真正的英语单词，每个单词可能会在网格中出现一次或多次，或者根本不出现。

Cel 已经成功创建了单词搜索拼图。

但是，存在一个问题：拼图太大而无法在一张纸上打印。

随着 Siv 的生日日益临近，已经没有足够的时间让她从头开始创建一个新的单词搜索拼图了。

因此 Cel 想通过从原始网格中截取一个矩形子网格作为新拼图从而减少拼图的面积。

但是随机选择一个子网格可能会导致拼图中没有很多隐藏的单词，而使拼图变得无聊。

因此，Cel 希望选择具有最大趣味值的子网格，其中子网格的趣味值定义为：

趣味值 =（匹配的单词总长度）/（（子网格的宽度）+（子网格的高度））

注意：

整个单词必须完整出现在要计算的子网格中。

如果一个单词在子网格中出现 *x* 次，则其长度应在上面的公式中加 *x* 次。

如果一个单词及其反向都出现在子网格中（即使在相同的位置！），则都计入出现次数。

具有最大趣味值的子网格可能是整个原始网格。

你能否帮助 Cel 找到子网格可能拥有的最大趣味值，以及具有这种趣味值的不同子网格的数量？

当且仅当网格中存在某个单元格在一个子网格中，而不在另一个子网格中时，两个子网格被认为是不同的。

### 输入格式

第一行包含整数 *T*，表示共有 *T* 组测试数据。

每组测试数据，第一行包含三个整数 *R,C,W*。

接下来 *R* 行，每行包含 *C* 个大写字母。

接下来 *W* 行，每行包含一个由大写字母构成的有效单词。

### 输出格式

每组数据输出一个结果，每个结果占一行。

结果表示为 `Case #x：y / z n`，其中 *x* 为组别编号（从 *1* 开始），*y / z* 是不可约分数，等于子网格的最大可能的趣味值。

*y* 是一个非负整数，*z* 是正整数，*n* 是趣味值等于 *y / z* 的子网格数。

如果 *y* 和 *z* 的最大公约数为 *1*，则 *y / z* 称为不可约分数。

### 数据范围

*1 ≤ T,R,C ≤ 100*,

同一单词最多在有效单词列表中出现一次，

有效单词列表中所有单词的总长度不超过 *5000* 个字母。

*1 ≤ W ≤ 1000*

### 输入样例：

```
4
1 2 1
AA
A
1 2 1
AA
B
1 3 2
ABC
ABC
CBA
4 4 1
AAAB
AAAB
AAAB
BBBB
AA
```

### 输出样例：

```
Case #1: 8/3 1
Case #2: 0/1 3
Case #3: 3/2 1
Case #4: 8/1 1
```

### 样例解释

以前两个样例为例。

设 *(i，j)* 表示第 *i* 行和第 *j* 列的单元。

在样例＃1中，具有最高趣味值的子网格是整个网格。

有效字 *A* 在网格中出现 *8* 次：

在单元 *(1,1)* 处水平 *2* 次（一次正向，一次反向）。

在单元 *(1,1)* 处垂直 *2* 次（一次正向，一次反向）。

在单元 *(1,2)* 处 *4* 次（水平和垂直，正向和反向）。

在样例＃2中，共有 *3* 个子网格，其有趣值均等于 *0*。
