## [705. 六边形](https://www.acwing.com/problem/content/707/)

### 题目

一个游戏是在 *N × N* 的棋盘上进行的，棋盘上每个格子都呈六边形。

有两个玩家：红方（使用红色石头）和蓝方（使用蓝色石头）。

棋盘在开始时是空的，两名玩家轮流将他们颜色的石头放在棋盘中的格子内。

每个玩家都可以将石头放在任何没有被石头占据的空格子内。

不要求必须将石头放在另一块相同颜色的石头旁边。

由谁先手是随机确定的（两个玩家先手的概率相等）。

棋盘的上侧和下侧标记为红色，另外两侧标记为蓝色。

游戏的目标是利用自己的石头构成一个连通路径，将与自己的石头颜色相同的两侧连通。

第一个实现这一目标的玩家获胜。

请注意，四个角被认为可以连接到两种颜色。

当一名玩家获胜时，游戏立即结束。

现在给定游戏状态，请你帮助新玩家确定目前的游戏局势。

游戏局势可能为以下之一：

- `Impossible`：在双方玩家都遵守规则的情况下，不可能达到目前的游戏状态。
- `Red wins`：红色玩家已经获胜。
- `Blue wins`：蓝色玩家已经获胜。
- `Nobody wins`：目前，没有玩家已经获胜。

请注意，只要一种游戏状态是不可能达到的，那么唯一正确输出答案就是 `Impossible`，无论场上目前局势是否有玩家已经获胜。

这是一个 *6 × 6* 棋盘上进行游戏的示例，蓝方先手并最终获胜。

 ![3.png](https://cdn.acwing.com/media/article/image/2019/04/18/19_6d3d586861-3.png)

### 输入格式

第一行包含整数 *T*，表示共有 *T* 组测试数据。

每组数据第一行包含整数 *N*，表示棋盘尺寸。

接下来 *N* 行，每行包含一个长度为 *N* 的字符串，用以描述目前的棋盘状态，字符串由 `R`， `B`， `.` 构成，其中 `R` 表示放有红色石头的格子， `B` 表示放有蓝色石头的格子， `.` 表示空格子。

### 输出格式

每组数据输出一个结果，每个结果占一行。

结果表示为 `Case #x: y`，其中 *x* 是组别编号（从 *1* 开始），*y* 是目前的游戏局势，可以为以下四种之一： `Impossible`， `Blue wins`， `Red wins`， `Nobody wins`。

### 数据范围

*1 ≤ T ≤ 100*,

*1 ≤ N ≤ 100*

### 输入样例：

```
7
1
.
1
B
1
R
2
BR
BB
4
BBBB
BBB.
RRR.
RRRR
4
BBBB
BBBB
RRR.
RRRR
6
......
..R...
BBBBBB
..R.R.
..RR..
......
```

### 输出样例：

```
Case #1: Nobody wins
Case #2: Blue wins
Case #3: Red wins
Case #4: Impossible
Case #5: Blue wins
Case #6: Impossible
Case #7: Blue wins
```
