## [539. 拼凑单词](https://www.acwing.com/problem/content/541/)

### 题目

Scrmable 教授在审阅一篇研究论文时发现，虽然论文中的一些单词出现了拼写错误，但她在阅读或理解这些词语时并没有出现阅读障碍。

在做了一些研究后，她发现了一篇如下所述的有趣文章：

根据英国大学的一项研究，一个单词中的字母的顺序无关紧要，唯一重要的是第一个和最后一个字母位于正确的位置。

剩下的部分哪怕是一团糟，你也可以毫无问题地阅读它。

这是因为人类在阅读时读取的是整个单词而不是每个字母。

Scrmable 教授希望进一步探索这个概念，并开始编写包含类似扰乱词的不同句子，并将其发送给一个受欢迎的出版社。

不幸的是，教授键盘上的空格键不起作用，因此她生成了一长串字符。

她要求你确定在这一长串字符中，有多少个在她词典中的单词出现过至少一次（原始单词或乱码形式均算）。 （乱码形式由同一组字母组成，其中第一个和最后一个字母位于相同位置，其他字母按任意顺序排列。）

请注意，词典单词可以在字符串中多次出现（尽管它应该只计算一次，因为我们只需要知道它是否至少出现一次）。

例如，如果我们在字典中有单词 `this`，那么可能计算的有效单词是 `this`（原始版本）和 `tihs`（加扰版本），而 `tsih`， `siht` 和其他变体无效，因为它们不是以 *t* 并以 *s* 结束。

此外， `tis`， `tiss` 和 `thiss` 不是乱码形式，因为它们不是原始字母集的重新排序。

由于教授非常忙碌，她将这项任务交给你来完成。

给定一个词典，请你计算在教授提供的长串字符中，有多少个词典中的单词出现过至少一次（原始单词或乱码形式均算）。

### 输入格式

第一行包含整数 *T*，表示共有 *T* 组测试数据。

每组数据包含三行，第一行包含整数 *L*，表示词典中单词的数目。

第二行包含由小写英文字母构成的 *L* 个单词列表，构成词典。

第三行包含两个小写英文字母 *S_1* 和 *S_2* 以及 *5* 个整数 *N,A,B,C,D*，其中 *S_1* 和 *S_2* 是教授提供的字符串 *S* 的前两个字符，*N* 是字符串 *S* 的长度，另外四个整数是你用来生成字符串 *S* 的参数，如下所示：

首先，我们将 *ord(c)* 定义为字符 *c* 的十进制整数值，将 *char(n)* 定义为小的整数 *n* 的字符值，例如，*ord(* `a` *)=97*，*char(97)=* `a`。

你可以参考 ASCII 表进行其他转换。

现在定义*x_1=ord(S_1),x_2=ord(S_2)*。

接下来，用下面的循环生成 *x_3* 到 *x_N*。

*x_i = (A * x_{i-1} + B * x_{i-2} + C) bmod D*

我们定义 *S_i = char(97 + (x_i bmod 26)),3 ≤ i ≤ N*。

### 输出格式

每组数据输出一个结果，每个结果占一行。

结果表示为 `Case #x: y`，其中 *x* 为组别编号（从 *1* 开始），*y* 为至少出现过一次的词典单词的数量。

### 数据范围

*1 ≤ T ≤ 20*,

词典中的单词均不相同，且单个单词长度在 *2* 到 *10^5* 之间，所有单词的总长度和不超过 *10^5*，

*0 ≤ A,B,C ≤ 10^9*,

*1 ≤ D ≤ 10^9*,

*1 ≤ L ≤ 1000*,

*2 ≤ N ≤ 1000*

### 输入样例：

```
1
5
axpaj apxaj dnrbt pjxdn abd
a a 50 1 1 1 30
```

### 输出样例：

```
Case #1: 4
```

### 样例解释

在样例中，利用给定生成法生成的字符串 *S* 为

aapxjdnrbtvldptfzbbdbbzxtndrvjblnzjfpvhdhhpxjdnrbt

词典单词的出现显示如下：

*axpaj* 以其乱码形式出现，如 **aapxj** dnrbtvldptfzbbdbbzxtndrvjblnzjfpvhdhhpxjdnrbt。

*apxaj* 以其乱码形式出现，如 **aapxj** dnrbtvldptfzbbdbbzxtndrvjblnzjfpvhdhhpxjdnrbt，即使 *apxaj* 是另一个字典单词 *axpaj* 的乱码形式，两者也都应该被计算在内。

*dnrbt* 以其原始形式出现两次，如 aapxj **dnrbt** vldptfzbbdbbzxtndrvjblnzjfpvhdhhpxj **dnrbt**，当然只计算一次。

*pjxdn* 以其乱码形式出现，如 aa **pxjdn** rbtvldptfzbbdbbzxtndrvjblnzjfpvhdhhpxjdnrbt，请注意，这种情况与另一个字典单词的出现重叠，但它们仍然是独立计算的。

*abd* 未出现。
