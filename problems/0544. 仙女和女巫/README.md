## [544. 仙女和女巫](https://www.acwing.com/problem/content/546/)

### 题目

帕里是一个强大的仙女，正在努力保护仙境免受邪恶的女巫们破坏。

女巫们每天都变得越来越强大，所以帕里必须使用大量魔法棒来施放保护法术。

她可以通过将这些魔法棒布置成面积大于 *0* 的凸多边形来实现法术的释放。

但是，帕里不一定能够使用到所有她想使用的魔法棒！

仙境中所有可用的魔法棒都被包装在一起，形成一个图形，图形的边由魔法棒构成，图形的节点是一根或多根魔法棒的端点。（除了在端点之外，魔法棒永远不会相互接触;它们是神奇的！）

每当帕里移除一根魔法棒用于她的咒语时，与该魔法棒相邻（即与该魔法棒共用一个节点）的所有魔法棒将永远消失不能在将来使用。

帕里想知道从图中选取若干个魔法棒构成魔法棒子集，使得子集中的魔法棒都能够被移除并且可以用于布置面积大于 *0* 的凸多边形，这样满足条件的魔法棒子集有多少个。

所有的魔法棒都被认为是不同的，即使两个魔法棒长度相同。

两个魔法棒集，当且仅当至少包含一个魔法棒的子集存在于一个魔法棒集之中而不存在于另一个魔法棒集之中时，我们认为两个魔法棒集是不同的。

如上所述，只有存在一种方法可以将该子集中的所有魔法棒从图中移除而不使子集中其他魔法棒消失时，子集才有效。

提示：给定一个图，从图中选取若干条边，边与边之间不能有共同端点，并且要能组成一个面积大于 *0* 的凸多边形，求一共有多少种不同的选择方案。

### 输入格式

第一行包含整数 *T*，表示共有 *T* 组测试数据。

每组测试数据第一行包含整数 *N*，表示由魔法棒构成的图的节点数。

接下来 *N* 行，每行包含 *N* 个整数，其中第 *i* 行第 *j* 个整数 *L_{i,j}* 表示第 *i* 个节点和第 *j* 个节点之间存在一个魔法棒，且长度为 *L_{i,j}*。

如果两个节点之间不存在魔法棒则 *L_{i,j}* 为 *0*。

### 输出格式

每组数据输出一个结果，每个结果占一行。

结果表示为 `Case #x: y`，其中 *x* 为组别编号（从 *1* 开始），*y* 为上述有效子集的数量。

### 数据范围

*1 ≤ T ≤ 100*,

*0 ≤ L_{i,j} ≤ 1000*,

*L_{i,i} = 0*,

*L_{i,j} = L_{j,i}*,

*6 ≤ N ≤ 15*,

### 输入样例：

```
5
6
0 1 0 0 0 0
1 0 1 0 0 0
0 1 0 1 0 0
0 0 1 0 1 0
0 0 0 1 0 1
0 0 0 0 1 0
6
0 2 0 0 0 0
2 0 0 0 0 0
0 0 0 3 0 0
0 0 3 0 0 0
0 0 0 0 0 4
0 0 0 0 4 0
6
0 1 0 0 0 0
1 0 0 0 0 0
0 0 0 2 0 0
0 0 2 0 0 0
0 0 0 0 0 4
0 0 0 0 4 0
6
0 1 1 1 1 1
1 0 0 0 0 0
1 0 0 0 0 0
1 0 0 0 0 0
1 0 0 0 0 0
1 0 0 0 0 0
8
0 5 0 0 0 0 0 0
5 0 0 0 0 0 0 0
0 0 0 5 0 0 0 0
0 0 5 0 0 0 0 0
0 0 0 0 0 5 0 0
0 0 0 0 5 0 0 0
0 0 0 0 0 0 0 5
0 0 0 0 0 0 5 0
```

### 输出样例：

```
Case #1: 1
Case #2: 1
Case #3: 0
Case #4: 0
Case #5: 5
```

### 样例解释

在样例*＃1*中，图中包含 *5* 个长度相同的魔法棒; 通过连接它们的节点表示这些魔法棒，分别为 *1-2,2-3,3-4,4-5* 和 *5-6*。 要形成一个封闭的多边形，我们至少需要拿出三个魔法棒，唯一方法是拿掉 *1-2,3-4* 和 *5-6*。

在样例*＃2*中，图表包含 *3* 个魔法棒，*1-2,3-4* 和 *5-6*。两两互不相连，因此我们可以将三个魔法棒都拿掉形成边长为 *2,3* 和 *4* 的三角形。

在样例*＃3*中，图表包含 *3* 个魔法棒，*1-2,3-4* 和 *5-6*。两两互不相连，因此我们可以将三个魔法棒都拿掉，但是我们不能用长度为 *1,2* 和 *4* 的魔法棒形成一个凸多边形。

在样例*＃4*中，所有魔法棒都连在一起，只能拿掉其中一根，肯定无法形成凸多边形。

在样例*＃5*中，图中包含的 *4* 个魔法棒都具有相同的长度且互不相连。 因此有四种形成三角形的方法和一种形成正方形的方法。
