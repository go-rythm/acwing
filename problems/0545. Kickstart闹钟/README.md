## [545. Kickstart闹钟](https://www.acwing.com/problem/content/547/)

### 题目

Shil 每天早上都很难醒来，因此他决定买一个强大的闹钟来负责每天叫醒他。

这个闹钟称为 Kickstart 闹钟。

它预先配置了 *K* 次唤醒呼叫。

在睡觉之前，用户需将闹钟的参数序列 *A_1，A_2，…，A_N* 设置完毕。

在早上，时钟将响铃 *K* 次，第 *i* 次唤醒呼叫的强度为 *POWER_i*。

为了计算 *POWER_i*，需要生成参数序列 *A* 的所有连续子序列，并计算所有连续子序列的第 *i* 个指数幂的总和。

子序列 *A_j，A_{j + 1}，…，A_k* 的第 *i* 个指数幂定义为 *A_j×1^i + A_{j + 1}×2^i + A_{j + 2}×3^i + … + A_k×(k-j +1)^i*。

因此 *POWER_i* 即为参数序列的所有连续子序列的第 *i* 个指数幂的总和。

例如，如果 *i = 2*，并且 *A = [1,4,2]*，那么 *A* 的第 *i* 个指数幂将如下计算：

*[1]* 的 *2* 指数幂 *= 1×1^2 = 1*

*[4]* 的 *2* 指数幂 *= 4×1^2 = 4*

*[2]* 的 *2* 指数幂 *= 2×1^2 = 2*

*[1,4]* 的 *2* 指数幂 *= 1×1^2 + 4×2^2 = 17*

*[4,2]* 的 *2* 指数幂 *= 4×1^2 + 2×2^2 = 12*

*[1,4,2]* 的 *2* 指数幂 *= 1×1^2 + 4×2^2 + 2×3^2 = 35*

所以 *POWER_i* 为 *1 + 4 + 2 + 17 + 12 + 35 = 71*。

今晚，Shil 第一次使用他的 Kickstart 闹钟。

因此，他非常担心早上闹钟发出的声音太大吵到邻居。

但是，计算每次唤醒呼叫的强度对他来说非常困难。

给定 *K* 和参数序列 *A_1，A_2，…，A_N*，请你帮他计算每个唤醒呼叫的强度总和：*POWER_1 + POWER_2 + … + POWER_K*。

### 输入格式

第一行包含整数 *T*，表示共有 *T* 组测试数据。

每个数据由一行九个整数 *N*，*K*，*x_1*，*y_1*，*C*，*D*，*E_1*，*E_2* 和 *F* 组成。*N* 是序列 *A* 的长度，*K* 是唤醒呼叫的次数。其余值是你用于生成序列 *A* 的元素的参数，如下所示。

用下列式子生成 *i=2* 至 *i=N* 的所有 *x_i* 和 *y_i*：

*x_i = ( C × x_{i-1} + D × y_{i-1} + E_1 ) bmod F*

*y_i = ( D × x_{i-1} + C × y_{i-1} + E_2 ) bmod F*

我们定义*A_i = ( x_i + y_i ) bmod F*

### 输出格式

每组数据输出一个结果，每个结果占一行。

结果表示为 `Case #x: POWER`，其中 *x* 为组别编号（从 *1* 开始），*POWER* 为上述强度总和对 *1000000007* 取模后的结果。

### 数据范围

*1 ≤ T ≤ 100*,

*1 ≤ x_1,y_1,C,D,E_1,E_2,F ≤ 10^5*,

*1 ≤ N ≤ 10^6*,

*1 ≤ K ≤ 10^4*

### 输入样例：

```
2
2 3 1 2 1 2 1 1 9
10 10 10001 10002 10003 10004 10005 10006 89273
```

### 输出样例：

```
Case #1: 52
Case #2: 739786670
```

### 样例解释

在样例*＃1*中，参数序列是 *[3,2]*。 所有连续的子序列为 *[3]，[2]，[3,2]*。

对于 *i = 1*：

*[3]* 的 *1* 指数幂 *= 3×1^1 = 3*

*[2]* 的 *1* 指数幂 *= 2×1^1 = 2*

*[3,2]* 的 *1* 指数幂 *= 3+2×2^1 = 7*

所以 *POWER_1* 是 *12*。

对于 *i = 2*：

*[3]* 的 *2* 指数幂 *= 3×1^2 = 3*

*[2]* 的 *2* 指数幂 *= 2×1^2 = 2*

*[3,2]* 的 *2* 指数幂 *= 3+2×2^2 = 11*

所以 *POWER_2* 是 *16*。

对于 *i = 3*：

*[3]* 的 *3* 指数幂 *= 3×1^3 = 3*

*[2]* 的 *3* 指数幂 *= 2×1^3 = 2*

*[3,2]* 的 *3* 指数幂 *= 3 + 2×2^3 = 19*

所以 *POWER_3* 是 *24*。

综上，强度和 *POWER = 12 + 16 + 24 = 52*
